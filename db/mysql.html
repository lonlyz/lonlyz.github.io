<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.49">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png"><link rel="manifest" href="/manifest.webmanifest"><meta name="application-name" content="VuePress"><meta name="apple-mobile-web-app-title" content="VuePress"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png"><link rel="mask-icon" href="/images/icons/safari-pinned-tab.svg" color="#3eaf7c"><meta name="msapplication-TileColor" content="#3eaf7c"><meta name="theme-color" content="#3eaf7c"><title>MYSQL | lz's blog</title><meta name="description" content="不积跬步无以至千里">
    <link rel="modulepreload" href="/assets/app.2d179ac6.js"><link rel="modulepreload" href="/assets/mysql.html.9341c39e.js"><link rel="modulepreload" href="/assets/mysql.html.e58b924c.js"><link rel="prefetch" href="/assets/index.html.ce922e96.js"><link rel="prefetch" href="/assets/contributing.html.3a411a07.js"><link rel="prefetch" href="/assets/architecture.html.4e6b8544.js"><link rel="prefetch" href="/assets/plugin.html.2478fd40.js"><link rel="prefetch" href="/assets/theme.html.0b332550.js"><link rel="prefetch" href="/assets/ArrayList.html.b1c78bb4.js"><link rel="prefetch" href="/assets/HashMap.html.183c3b82.js"><link rel="prefetch" href="/assets/LinkedList.html.6345d9c4.js"><link rel="prefetch" href="/assets/deploy.html.920f8ab9.js"><link rel="prefetch" href="/assets/design.html.022867f6.js"><link rel="prefetch" href="/assets/docker.html.cf8f042b.js"><link rel="prefetch" href="/assets/jvm.html.b9c03646.js"><link rel="prefetch" href="/assets/linux.html.6d4fd70c.js"><link rel="prefetch" href="/assets/maven.html.61a6d70e.js"><link rel="prefetch" href="/assets/securityManager.html.8a98cf93.js"><link rel="prefetch" href="/assets/dubbo.html.5711a22c.js"><link rel="prefetch" href="/assets/mybatis_analyse.html.026ce764.js"><link rel="prefetch" href="/assets/spring_analyse.html.190cb23c.js"><link rel="prefetch" href="/assets/springboot.html.19e6846c.js"><link rel="prefetch" href="/assets/springcloud.html.8e65ac04.js"><link rel="prefetch" href="/assets/zookeeper.html.8965cbc3.js"><link rel="prefetch" href="/assets/elasticsearch.html.b4a652db.js"><link rel="prefetch" href="/assets/mycat.html.efc17ef6.js"><link rel="prefetch" href="/assets/redis.html.c8fd5471.js"><link rel="prefetch" href="/assets/index.html.144e86d9.js"><link rel="prefetch" href="/assets/assets.html.6149a9cd.js"><link rel="prefetch" href="/assets/bundler.html.41d883e3.js"><link rel="prefetch" href="/assets/configuration.html.569fcb10.js"><link rel="prefetch" href="/assets/deployment.html.2e87e1d3.js"><link rel="prefetch" href="/assets/getting-started.html.ee18f05f.js"><link rel="prefetch" href="/assets/i18n.html.4876761d.js"><link rel="prefetch" href="/assets/markdown.html.1608d7fe.js"><link rel="prefetch" href="/assets/migration.html.758299a9.js"><link rel="prefetch" href="/assets/page.html.9eda836b.js"><link rel="prefetch" href="/assets/plugin.html.6f7595db.js"><link rel="prefetch" href="/assets/theme.html.af5fe1f9.js"><link rel="prefetch" href="/assets/cli.html.7cc9ace8.js"><link rel="prefetch" href="/assets/client-api.html.43c5721d.js"><link rel="prefetch" href="/assets/components.html.b203dc2e.js"><link rel="prefetch" href="/assets/config.html.5d675754.js"><link rel="prefetch" href="/assets/frontmatter.html.cb7902b9.js"><link rel="prefetch" href="/assets/node-api.html.e1ac08d3.js"><link rel="prefetch" href="/assets/plugin-api.html.acd6adb1.js"><link rel="prefetch" href="/assets/theme-api.html.dec36e8b.js"><link rel="prefetch" href="/assets/index.html.75cad36a.js"><link rel="prefetch" href="/assets/adding-extra-pages.html.f27ac48d.js"><link rel="prefetch" href="/assets/making-a-theme-extendable.html.01558906.js"><link rel="prefetch" href="/assets/markdown-and-vue-sfc.html.961fdf5e.js"><link rel="prefetch" href="/assets/passing-data-to-client-code.html.ca69bb2e.js"><link rel="prefetch" href="/assets/usage-of-client-config.html.b76cce07.js"><link rel="prefetch" href="/assets/vite.html.d4303ee4.js"><link rel="prefetch" href="/assets/webpack.html.b0d629df.js"><link rel="prefetch" href="/assets/components.html.16fce079.js"><link rel="prefetch" href="/assets/config.html.79325d15.js"><link rel="prefetch" href="/assets/extending.html.d14a33d7.js"><link rel="prefetch" href="/assets/frontmatter.html.c97d0d05.js"><link rel="prefetch" href="/assets/markdown.html.1a13cc02.js"><link rel="prefetch" href="/assets/styles.html.ea86aa59.js"><link rel="prefetch" href="/assets/active-header-links.html.45b9bd02.js"><link rel="prefetch" href="/assets/back-to-top.html.af6ff50c.js"><link rel="prefetch" href="/assets/container.html.bef91a8d.js"><link rel="prefetch" href="/assets/docsearch.html.16f4c15e.js"><link rel="prefetch" href="/assets/external-link-icon.html.76af1764.js"><link rel="prefetch" href="/assets/git.html.247e0ffd.js"><link rel="prefetch" href="/assets/google-analytics.html.9c016e93.js"><link rel="prefetch" href="/assets/medium-zoom.html.1dc25251.js"><link rel="prefetch" href="/assets/nprogress.html.893a0104.js"><link rel="prefetch" href="/assets/palette.html.729169ee.js"><link rel="prefetch" href="/assets/prismjs.html.f6a4ae7c.js"><link rel="prefetch" href="/assets/pwa-popup.html.b3d39037.js"><link rel="prefetch" href="/assets/pwa.html.adb71ea8.js"><link rel="prefetch" href="/assets/register-components.html.de3ea1e4.js"><link rel="prefetch" href="/assets/search.html.cf5783e8.js"><link rel="prefetch" href="/assets/shiki.html.a1abdee1.js"><link rel="prefetch" href="/assets/theme-data.html.c90a70db.js"><link rel="prefetch" href="/assets/toc.html.bbb10448.js"><link rel="prefetch" href="/assets/404.html.265028f6.js"><link rel="prefetch" href="/assets/index.html.f7b63dec.js"><link rel="prefetch" href="/assets/contributing.html.fcaafa92.js"><link rel="prefetch" href="/assets/architecture.html.05debc79.js"><link rel="prefetch" href="/assets/plugin.html.a0cb5d5b.js"><link rel="prefetch" href="/assets/theme.html.69728f0b.js"><link rel="prefetch" href="/assets/ArrayList.html.e25ef4ab.js"><link rel="prefetch" href="/assets/HashMap.html.ca40b73f.js"><link rel="prefetch" href="/assets/LinkedList.html.591b0937.js"><link rel="prefetch" href="/assets/deploy.html.510dc198.js"><link rel="prefetch" href="/assets/design.html.2d9ceaf2.js"><link rel="prefetch" href="/assets/docker.html.664d5f64.js"><link rel="prefetch" href="/assets/jvm.html.98ed9d7f.js"><link rel="prefetch" href="/assets/linux.html.5b144f58.js"><link rel="prefetch" href="/assets/maven.html.ab0caf1a.js"><link rel="prefetch" href="/assets/securityManager.html.bba423da.js"><link rel="prefetch" href="/assets/dubbo.html.8f6fe996.js"><link rel="prefetch" href="/assets/mybatis_analyse.html.67db7a70.js"><link rel="prefetch" href="/assets/spring_analyse.html.25b362df.js"><link rel="prefetch" href="/assets/springboot.html.89f6a9b4.js"><link rel="prefetch" href="/assets/springcloud.html.bd3c2463.js"><link rel="prefetch" href="/assets/zookeeper.html.53b5dc84.js"><link rel="prefetch" href="/assets/elasticsearch.html.4d9b533d.js"><link rel="prefetch" href="/assets/mycat.html.e8bce3fc.js"><link rel="prefetch" href="/assets/redis.html.ef4e78a8.js"><link rel="prefetch" href="/assets/index.html.db16eed3.js"><link rel="prefetch" href="/assets/assets.html.2314c7eb.js"><link rel="prefetch" href="/assets/bundler.html.24e5be97.js"><link rel="prefetch" href="/assets/configuration.html.259cd78e.js"><link rel="prefetch" href="/assets/deployment.html.b7d3dd68.js"><link rel="prefetch" href="/assets/getting-started.html.fa9442a2.js"><link rel="prefetch" href="/assets/i18n.html.52274ece.js"><link rel="prefetch" href="/assets/markdown.html.05711a31.js"><link rel="prefetch" href="/assets/migration.html.2be0c1c9.js"><link rel="prefetch" href="/assets/page.html.300f104e.js"><link rel="prefetch" href="/assets/plugin.html.385c351b.js"><link rel="prefetch" href="/assets/theme.html.576cac10.js"><link rel="prefetch" href="/assets/cli.html.f9cb9f61.js"><link rel="prefetch" href="/assets/client-api.html.943d4e52.js"><link rel="prefetch" href="/assets/components.html.21454798.js"><link rel="prefetch" href="/assets/config.html.32d4906f.js"><link rel="prefetch" href="/assets/frontmatter.html.4d600b76.js"><link rel="prefetch" href="/assets/node-api.html.96f0e82c.js"><link rel="prefetch" href="/assets/plugin-api.html.df57c385.js"><link rel="prefetch" href="/assets/theme-api.html.40f0e433.js"><link rel="prefetch" href="/assets/index.html.75050212.js"><link rel="prefetch" href="/assets/adding-extra-pages.html.95427f8d.js"><link rel="prefetch" href="/assets/making-a-theme-extendable.html.ccf8a50a.js"><link rel="prefetch" href="/assets/markdown-and-vue-sfc.html.db584977.js"><link rel="prefetch" href="/assets/passing-data-to-client-code.html.82aa0df7.js"><link rel="prefetch" href="/assets/usage-of-client-config.html.c9ad052e.js"><link rel="prefetch" href="/assets/vite.html.27fa01f8.js"><link rel="prefetch" href="/assets/webpack.html.f864ac5e.js"><link rel="prefetch" href="/assets/components.html.d57f6f9c.js"><link rel="prefetch" href="/assets/config.html.83041e14.js"><link rel="prefetch" href="/assets/extending.html.17dc183d.js"><link rel="prefetch" href="/assets/frontmatter.html.1b196089.js"><link rel="prefetch" href="/assets/markdown.html.a51c4b7b.js"><link rel="prefetch" href="/assets/styles.html.2ed7c337.js"><link rel="prefetch" href="/assets/active-header-links.html.fd52a36b.js"><link rel="prefetch" href="/assets/back-to-top.html.c3457ba9.js"><link rel="prefetch" href="/assets/container.html.fefb86b8.js"><link rel="prefetch" href="/assets/docsearch.html.5efe2d39.js"><link rel="prefetch" href="/assets/external-link-icon.html.7a8e229f.js"><link rel="prefetch" href="/assets/git.html.9b12fda6.js"><link rel="prefetch" href="/assets/google-analytics.html.d08ec2de.js"><link rel="prefetch" href="/assets/medium-zoom.html.462f60a6.js"><link rel="prefetch" href="/assets/nprogress.html.87cc8a65.js"><link rel="prefetch" href="/assets/palette.html.2f488465.js"><link rel="prefetch" href="/assets/prismjs.html.e4cc4ad1.js"><link rel="prefetch" href="/assets/pwa-popup.html.b4fb4e5c.js"><link rel="prefetch" href="/assets/pwa.html.08d0a52e.js"><link rel="prefetch" href="/assets/register-components.html.9e785502.js"><link rel="prefetch" href="/assets/search.html.0d386121.js"><link rel="prefetch" href="/assets/shiki.html.7cf16601.js"><link rel="prefetch" href="/assets/theme-data.html.f1478668.js"><link rel="prefetch" href="/assets/toc.html.c3c80b86.js"><link rel="prefetch" href="/assets/404.html.d344f66d.js"><link rel="prefetch" href="/assets/404.14d2f7d4.js"><link rel="prefetch" href="/assets/Layout.32917280.js"><link rel="prefetch" href="/assets/NpmBadge.6b229c37.js">
    <link rel="stylesheet" href="/assets/style.a0deccd5.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/hero.png" alt="lz&#39;s blog"><span class="site-name can-hide">lz&#39;s blog</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/guide/" class="" aria-label="指南"><!--[--><!--]--> 指南 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="基础"><span class="title">基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="基础"><span class="title">基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>集合</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/basic/ArrayList.html" class="" aria-label="ArrayList"><!--[--><!--]--> ArrayList <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/HashMap.html" class="" aria-label="HashMap"><!--[--><!--]--> HashMap <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/LinkedList.html" class="" aria-label="LinkedList"><!--[--><!--]--> LinkedList <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>其它</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/basic/deploy.html" class="" aria-label="服务器部署"><!--[--><!--]--> 服务器部署 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/design.html" class="" aria-label="设计模式"><!--[--><!--]--> 设计模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/jvm.html" class="" aria-label="JVM内存管理"><!--[--><!--]--> JVM内存管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/securityManager.html" class="" aria-label="SecurityManager"><!--[--><!--]--> SecurityManager <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/docker.html" class="" aria-label="Docker 使用和各个软件的安装"><!--[--><!--]--> Docker 使用和各个软件的安装 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/linux.html" class="" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/maven.html" class="" aria-label="Maven"><!--[--><!--]--> Maven <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="框架"><span class="title">框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="框架"><span class="title">框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>常用</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/construct/dubbo.html" class="" aria-label="Dubbo"><!--[--><!--]--> Dubbo <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/construct/mybatis_analyse.html" class="" aria-label="Mybatis源码分析"><!--[--><!--]--> Mybatis源码分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/construct/spring_analyse.html" class="" aria-label="Spring IOC源码分析"><!--[--><!--]--> Spring IOC源码分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/construct/springboot.html" class="" aria-label="Spring Boot 入门"><!--[--><!--]--> Spring Boot 入门 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/construct/springcloud.html" class="" aria-label="Spring Cloud 入门"><!--[--><!--]--> Spring Cloud 入门 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/construct/zookeeper.html" class="" aria-label="Zookeeper"><!--[--><!--]--> Zookeeper <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>常用</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/db/elasticsearch.html" class="" aria-label="ElasticSearch"><!--[--><!--]--> ElasticSearch <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/db/mycat.html" class="" aria-label="Mycat"><!--[--><!--]--> Mycat <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a aria-current="page" href="/db/mysql.html" class="router-link-active router-link-exact-active router-link-active" aria-label="MYSQL"><!--[--><!--]--> MYSQL <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/db/redis.html" class="" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="在线文档"><span class="title">在线文档</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="在线文档"><span class="title">在线文档</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>前端文档</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://cn.vuejs.org/v2/guide/" rel="noopener noreferrer" target="_blank" aria-label="Vue"><!--[--><!--]--> Vue <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.antdv.com/docs/vue/introduce-cn/" rel="noopener noreferrer" target="_blank" aria-label="Vue ant design"><!--[--><!--]--> Vue ant design <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.kancloud.cn/yunye/axios/234845" rel="noopener noreferrer" target="_blank" aria-label="Axios"><!--[--><!--]--> Axios <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="参考"><span class="title">参考</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="参考"><span class="title">参考</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>VuePress</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/cli.html" class="" aria-label="命令行接口"><!--[--><!--]--> 命令行接口 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/config.html" class="" aria-label="配置"><!--[--><!--]--> 配置 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/frontmatter.html" class="" aria-label="Frontmatter"><!--[--><!--]--> Frontmatter <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/components.html" class="" aria-label="内置组件"><!--[--><!--]--> 内置组件 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin-api.html" class="" aria-label="插件 API"><!--[--><!--]--> 插件 API <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/theme-api.html" class="" aria-label="主题 API"><!--[--><!--]--> 主题 API <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/client-api.html" class="" aria-label="客户端 API"><!--[--><!--]--> 客户端 API <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/node-api.html" class="" aria-label="Node API"><!--[--><!--]--> Node API <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>打包工具</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/bundler/vite.html" class="" aria-label="Vite"><!--[--><!--]--> Vite <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/bundler/webpack.html" class="" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>默认主题</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/config.html" class="" aria-label="配置"><!--[--><!--]--> 配置 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/frontmatter.html" class="" aria-label="Frontmatter"><!--[--><!--]--> Frontmatter <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/components.html" class="" aria-label="内置组件"><!--[--><!--]--> 内置组件 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/markdown.html" class="" aria-label="Markdown"><!--[--><!--]--> Markdown <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/styles.html" class="" aria-label="样式"><!--[--><!--]--> 样式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/extending.html" class="" aria-label="继承"><!--[--><!--]--> 继承 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="插件"><span class="title">插件</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="插件"><span class="title">插件</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>常用功能</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/plugin/back-to-top.html" class="" aria-label="back-to-top"><!--[--><!--]--> back-to-top <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/container.html" class="" aria-label="container"><!--[--><!--]--> container <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/external-link-icon.html" class="" aria-label="external-link-icon"><!--[--><!--]--> external-link-icon <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/google-analytics.html" class="" aria-label="google-analytics"><!--[--><!--]--> google-analytics <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/medium-zoom.html" class="" aria-label="medium-zoom"><!--[--><!--]--> medium-zoom <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/nprogress.html" class="" aria-label="nprogress"><!--[--><!--]--> nprogress <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/register-components.html" class="" aria-label="register-components"><!--[--><!--]--> register-components <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>内容搜索</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/plugin/docsearch.html" class="" aria-label="docsearch"><!--[--><!--]--> docsearch <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/search.html" class="" aria-label="search"><!--[--><!--]--> search <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>PWA</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/plugin/pwa.html" class="" aria-label="pwa"><!--[--><!--]--> pwa <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/pwa-popup.html" class="" aria-label="pwa-popup"><!--[--><!--]--> pwa-popup <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>语法高亮</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/plugin/prismjs.html" class="" aria-label="prismjs"><!--[--><!--]--> prismjs <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/shiki.html" class="" aria-label="shiki"><!--[--><!--]--> shiki <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>主题开发</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/plugin/active-header-links.html" class="" aria-label="active-header-links"><!--[--><!--]--> active-header-links <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/git.html" class="" aria-label="git"><!--[--><!--]--> git <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/palette.html" class="" aria-label="palette"><!--[--><!--]--> palette <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/theme-data.html" class="" aria-label="theme-data"><!--[--><!--]--> theme-data <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/toc.html" class="" aria-label="toc"><!--[--><!--]--> toc <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>深入</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/advanced/architecture.html" class="" aria-label="架构"><!--[--><!--]--> 架构 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/advanced/plugin.html" class="" aria-label="开发插件"><!--[--><!--]--> 开发插件 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/advanced/theme.html" class="" aria-label="开发主题"><!--[--><!--]--> 开发主题 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/advanced/cookbook/" class="" aria-label="Cookbook"><!--[--><!--]--> Cookbook <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>其他资源</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/contributing.html" class="" aria-label="贡献指南"><!--[--><!--]--> 贡献指南 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/vuepress/awesome-vuepress" rel="noopener noreferrer" target="_blank" aria-label="Awesome VuePress"><!--[--><!--]--> Awesome VuePress <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="v2.0.0-beta.49"><span class="title">v2.0.0-beta.49</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="v2.0.0-beta.49"><span class="title">v2.0.0-beta.49</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/vuepress/vuepress-next/blob/main/CHANGELOG.md" rel="noopener noreferrer" target="_blank" aria-label="更新日志"><!--[--><!--]--> 更新日志 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://v1.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="v1.x"><!--[--><!--]--> v1.x <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://v0.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="v0.x"><!--[--><!--]--> v0.x <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/lonlyz/blog" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="切换颜色模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/guide/" class="" aria-label="指南"><!--[--><!--]--> 指南 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="基础"><span class="title">基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="基础"><span class="title">基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>集合</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/basic/ArrayList.html" class="" aria-label="ArrayList"><!--[--><!--]--> ArrayList <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/HashMap.html" class="" aria-label="HashMap"><!--[--><!--]--> HashMap <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/LinkedList.html" class="" aria-label="LinkedList"><!--[--><!--]--> LinkedList <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>其它</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/basic/deploy.html" class="" aria-label="服务器部署"><!--[--><!--]--> 服务器部署 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/design.html" class="" aria-label="设计模式"><!--[--><!--]--> 设计模式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/jvm.html" class="" aria-label="JVM内存管理"><!--[--><!--]--> JVM内存管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/securityManager.html" class="" aria-label="SecurityManager"><!--[--><!--]--> SecurityManager <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/docker.html" class="" aria-label="Docker 使用和各个软件的安装"><!--[--><!--]--> Docker 使用和各个软件的安装 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/linux.html" class="" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/basic/maven.html" class="" aria-label="Maven"><!--[--><!--]--> Maven <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="框架"><span class="title">框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="框架"><span class="title">框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>常用</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/construct/dubbo.html" class="" aria-label="Dubbo"><!--[--><!--]--> Dubbo <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/construct/mybatis_analyse.html" class="" aria-label="Mybatis源码分析"><!--[--><!--]--> Mybatis源码分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/construct/spring_analyse.html" class="" aria-label="Spring IOC源码分析"><!--[--><!--]--> Spring IOC源码分析 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/construct/springboot.html" class="" aria-label="Spring Boot 入门"><!--[--><!--]--> Spring Boot 入门 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/construct/springcloud.html" class="" aria-label="Spring Cloud 入门"><!--[--><!--]--> Spring Cloud 入门 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/construct/zookeeper.html" class="" aria-label="Zookeeper"><!--[--><!--]--> Zookeeper <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>常用</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/db/elasticsearch.html" class="" aria-label="ElasticSearch"><!--[--><!--]--> ElasticSearch <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/db/mycat.html" class="" aria-label="Mycat"><!--[--><!--]--> Mycat <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a aria-current="page" href="/db/mysql.html" class="router-link-active router-link-exact-active router-link-active" aria-label="MYSQL"><!--[--><!--]--> MYSQL <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/db/redis.html" class="" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="在线文档"><span class="title">在线文档</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="在线文档"><span class="title">在线文档</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>前端文档</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://cn.vuejs.org/v2/guide/" rel="noopener noreferrer" target="_blank" aria-label="Vue"><!--[--><!--]--> Vue <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.antdv.com/docs/vue/introduce-cn/" rel="noopener noreferrer" target="_blank" aria-label="Vue ant design"><!--[--><!--]--> Vue ant design <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.kancloud.cn/yunye/axios/234845" rel="noopener noreferrer" target="_blank" aria-label="Axios"><!--[--><!--]--> Axios <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="参考"><span class="title">参考</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="参考"><span class="title">参考</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>VuePress</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/cli.html" class="" aria-label="命令行接口"><!--[--><!--]--> 命令行接口 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/config.html" class="" aria-label="配置"><!--[--><!--]--> 配置 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/frontmatter.html" class="" aria-label="Frontmatter"><!--[--><!--]--> Frontmatter <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/components.html" class="" aria-label="内置组件"><!--[--><!--]--> 内置组件 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin-api.html" class="" aria-label="插件 API"><!--[--><!--]--> 插件 API <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/theme-api.html" class="" aria-label="主题 API"><!--[--><!--]--> 主题 API <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/client-api.html" class="" aria-label="客户端 API"><!--[--><!--]--> 客户端 API <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/node-api.html" class="" aria-label="Node API"><!--[--><!--]--> Node API <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>打包工具</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/bundler/vite.html" class="" aria-label="Vite"><!--[--><!--]--> Vite <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/bundler/webpack.html" class="" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>默认主题</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/config.html" class="" aria-label="配置"><!--[--><!--]--> 配置 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/frontmatter.html" class="" aria-label="Frontmatter"><!--[--><!--]--> Frontmatter <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/components.html" class="" aria-label="内置组件"><!--[--><!--]--> 内置组件 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/markdown.html" class="" aria-label="Markdown"><!--[--><!--]--> Markdown <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/styles.html" class="" aria-label="样式"><!--[--><!--]--> 样式 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/default-theme/extending.html" class="" aria-label="继承"><!--[--><!--]--> 继承 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="插件"><span class="title">插件</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="插件"><span class="title">插件</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>常用功能</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/plugin/back-to-top.html" class="" aria-label="back-to-top"><!--[--><!--]--> back-to-top <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/container.html" class="" aria-label="container"><!--[--><!--]--> container <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/external-link-icon.html" class="" aria-label="external-link-icon"><!--[--><!--]--> external-link-icon <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/google-analytics.html" class="" aria-label="google-analytics"><!--[--><!--]--> google-analytics <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/medium-zoom.html" class="" aria-label="medium-zoom"><!--[--><!--]--> medium-zoom <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/nprogress.html" class="" aria-label="nprogress"><!--[--><!--]--> nprogress <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/register-components.html" class="" aria-label="register-components"><!--[--><!--]--> register-components <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>内容搜索</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/plugin/docsearch.html" class="" aria-label="docsearch"><!--[--><!--]--> docsearch <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/search.html" class="" aria-label="search"><!--[--><!--]--> search <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>PWA</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/plugin/pwa.html" class="" aria-label="pwa"><!--[--><!--]--> pwa <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/pwa-popup.html" class="" aria-label="pwa-popup"><!--[--><!--]--> pwa-popup <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>语法高亮</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/plugin/prismjs.html" class="" aria-label="prismjs"><!--[--><!--]--> prismjs <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/shiki.html" class="" aria-label="shiki"><!--[--><!--]--> shiki <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>主题开发</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/reference/plugin/active-header-links.html" class="" aria-label="active-header-links"><!--[--><!--]--> active-header-links <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/git.html" class="" aria-label="git"><!--[--><!--]--> git <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/palette.html" class="" aria-label="palette"><!--[--><!--]--> palette <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/theme-data.html" class="" aria-label="theme-data"><!--[--><!--]--> theme-data <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/reference/plugin/toc.html" class="" aria-label="toc"><!--[--><!--]--> toc <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>深入</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/advanced/architecture.html" class="" aria-label="架构"><!--[--><!--]--> 架构 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/advanced/plugin.html" class="" aria-label="开发插件"><!--[--><!--]--> 开发插件 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/advanced/theme.html" class="" aria-label="开发主题"><!--[--><!--]--> 开发主题 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/advanced/cookbook/" class="" aria-label="Cookbook"><!--[--><!--]--> Cookbook <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>其他资源</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/contributing.html" class="" aria-label="贡献指南"><!--[--><!--]--> 贡献指南 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/vuepress/awesome-vuepress" rel="noopener noreferrer" target="_blank" aria-label="Awesome VuePress"><!--[--><!--]--> Awesome VuePress <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="v2.0.0-beta.49"><span class="title">v2.0.0-beta.49</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="v2.0.0-beta.49"><span class="title">v2.0.0-beta.49</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/vuepress/vuepress-next/blob/main/CHANGELOG.md" rel="noopener noreferrer" target="_blank" aria-label="更新日志"><!--[--><!--]--> 更新日志 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://v1.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="v1.x"><!--[--><!--]--> v1.x <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://v0.vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="v0.x"><!--[--><!--]--> v0.x <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/lonlyz/blog" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">数据库 <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/db/elasticsearch.html" class="sidebar-item" aria-label="ElasticSearch"><!--[--><!--]--> ElasticSearch <!--[--><!--]--></a><!----></li><li><a href="/db/mycat.html" class="sidebar-item" aria-label="Mycat"><!--[--><!--]--> Mycat <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="MYSQL"><!--[--><!--]--> MYSQL <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/db/mysql.html#配置文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="配置文件"><!--[--><!--]--> 配置文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#逻辑架构" class="router-link-active router-link-exact-active sidebar-item" aria-label="逻辑架构"><!--[--><!--]--> 逻辑架构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#存储引擎" class="router-link-active router-link-exact-active sidebar-item" aria-label="存储引擎"><!--[--><!--]--> 存储引擎 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#mysql-性能优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="Mysql 性能优化"><!--[--><!--]--> Mysql 性能优化 <!--[--><!--]--></a><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/db/mysql.html#性能下降sql执行慢等待时间长" class="router-link-active router-link-exact-active sidebar-item" aria-label="性能下降sql执行慢等待时间长"><!--[--><!--]--> 性能下降sql执行慢等待时间长 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#常见的join查询-详细信息" class="router-link-active router-link-exact-active sidebar-item" aria-label="常见的join查询 详细信息"><!--[--><!--]--> 常见的join查询 详细信息 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#性能分析" class="router-link-active router-link-exact-active sidebar-item" aria-label="性能分析"><!--[--><!--]--> 性能分析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#索引分析" class="router-link-active router-link-exact-active sidebar-item" aria-label="索引分析"><!--[--><!--]--> 索引分析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#索引失效" class="router-link-active router-link-exact-active sidebar-item" aria-label="索引失效"><!--[--><!--]--> 索引失效 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#一般性建议" class="router-link-active router-link-exact-active sidebar-item" aria-label="一般性建议"><!--[--><!--]--> 一般性建议 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#优化总结口诀" class="router-link-active router-link-exact-active sidebar-item" aria-label="*优化总结口诀"><!--[--><!--]--> *优化总结口诀 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/db/mysql.html#查询截取分析" class="router-link-active router-link-exact-active sidebar-item" aria-label="查询截取分析"><!--[--><!--]--> 查询截取分析 <!--[--><!--]--></a><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/db/mysql.html#查询优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="查询优化"><!--[--><!--]--> 查询优化 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#批量插入数据脚本" class="router-link-active router-link-exact-active sidebar-item" aria-label="批量插入数据脚本"><!--[--><!--]--> 批量插入数据脚本 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#show-profile-分析" class="router-link-active router-link-exact-active sidebar-item" aria-label="show profile 分析"><!--[--><!--]--> show profile 分析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#show-profile-使用方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="show profile 使用方法"><!--[--><!--]--> show profile 使用方法 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#全局查询日志" class="router-link-active router-link-exact-active sidebar-item" aria-label="全局查询日志"><!--[--><!--]--> 全局查询日志 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/db/mysql.html#数据库锁理论" class="router-link-active router-link-exact-active sidebar-item" aria-label="数据库锁理论"><!--[--><!--]--> 数据库锁理论 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#主从复制" class="router-link-active router-link-exact-active sidebar-item" aria-label="主从复制"><!--[--><!--]--> 主从复制 <!--[--><!--]--></a><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/db/mysql.html#复制基本原理" class="router-link-active router-link-exact-active sidebar-item" aria-label="复制基本原理"><!--[--><!--]--> 复制基本原理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/db/mysql.html#主从复制配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="主从复制配置"><!--[--><!--]--> 主从复制配置 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="/db/redis.html" class="sidebar-item" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql" aria-hidden="true">#</a> MYSQL</h1><h2 id="配置文件" tabindex="-1"><a class="header-anchor" href="#配置文件" aria-hidden="true">#</a> 配置文件</h2><p><a target="_blank" href="/db/mysql/my.ini">查看文件</a></p><div class="language-ini ext-ini line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">转自：https://www.cnblogs.com/panwenbin-logs/p/8360703.html</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">#*** client options 相关选项 ***#</span></span>
<span class="line"><span style="color:#6A9955;">#以下选项会被MySQL客户端应用读取。注意只有MySQL附带的客户端应用程序保证可以读取这段内容。如果你想你自己的MySQL应用程序获取这些值。需要在MySQL客户端库初始化的时候指定这些选项。</span></span>
<span class="line"><span style="color:#D4D4D4;">[client]</span></span>
<span class="line"><span style="color:#569CD6;">port</span><span style="color:#D4D4D4;"> = 3309</span></span>
<span class="line"><span style="color:#569CD6;">socket</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/tmp/mysql.sock</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">[mysqld] </span><span style="color:#6A9955;">#服务器端配置</span></span>
<span class="line"><span style="color:#D4D4D4;">!include  /usr/local/mysql/etc/mysqld.cnf  </span><span style="color:#6A9955;">#包含的配置文件，可以把用户名和密码文件单独存放</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">port</span><span style="color:#D4D4D4;"> = 3306　　</span><span style="color:#6A9955;">#监听端口　　</span></span>
<span class="line"><span style="color:#569CD6;">bind-address</span><span style="color:#D4D4D4;"> = 0.0.0.0　　</span><span style="color:#6A9955;">#监听的ip地址</span></span>
<span class="line"><span style="color:#569CD6;">server-id</span><span style="color:#D4D4D4;"> = 1　　</span><span style="color:#6A9955;">#MySQL服务的ID</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">socket</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/tmp/mysql.sock　　</span><span style="color:#6A9955;">#socket通信设置</span></span>
<span class="line"><span style="color:#569CD6;">pid-file</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/var/mysql.pid　 </span><span style="color:#6A9955;">#pid文件路径</span></span>
<span class="line"><span style="color:#569CD6;">basedir</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/　　　　　　　　　　</span><span style="color:#6A9955;">#MySQL程序路径</span></span>
<span class="line"><span style="color:#569CD6;">datadir</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/data　　　　　　　 </span><span style="color:#6A9955;">#数据目录</span></span>
<span class="line"><span style="color:#569CD6;">tmpdir</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/tmp/ </span></span>
<span class="line"><span style="color:#6A9955;">#此目录被 MySQL用来保存临时文件.例如,它被用来处理基于磁盘的大型排序,和内部排序一样，以及简单的临时表.如果你不创建非常大的临时文件,将其放置到 swapfs/tmpfs 文件系统上也许比较好。另一种选择是你也可以将其放置在独立的磁盘上.你可以使用”;”来放置多个路径，他们会按照 roud-robin 方法被轮询使用.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">slave-load-tmpdir</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/tmp/  </span><span style="color:#6A9955;">#当slave执行load data infile时使用</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">#*** skip options 相关选项 ***#</span></span>
<span class="line"><span style="color:#D4D4D4;">skip-name-resolve </span></span>
<span class="line"><span style="color:#6A9955;">#禁止 MySQL 对外部连接进行 DNS 解析，使用这一选项可以消除 MySQL 进行 DNS 解析的时间。但需要注意，如果开启该选项，则所有远程主机连接授权都要使用 IP 地址方式，否则 MySQL 将无法正常处理连接请求！</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">skip-symbolic-links </span></span>
<span class="line"><span style="color:#6A9955;">#不能使用连接文件，多个客户可能会访问同一个数据库，因此这防止外部客户锁定 MySQL 服务器。 该选项默认开启</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">skip-external-locking </span></span>
<span class="line"><span style="color:#6A9955;">#不使用系统锁定，要使用 myisamchk,必须关闭服务器 ,避免 MySQL的外部锁定，减少出错几率增强稳定性。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">skip-slave-start </span></span>
<span class="line"><span style="color:#6A9955;">#启动 mysql,不启动复制</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">skip-networking </span></span>
<span class="line"><span style="color:#6A9955;">#开启该选项可以彻底关闭 MySQL 的 TCP/IP 连接方式，如果 WEB 服务器是以远程连接的方式访问 MySQL 数据库服务器则不要开启该选项！否则将无法正常连接！ 如果所有的进程都是在同一台服务器连接到本地的 mysqld, 这样设置将是增强安全的方法</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">sysdate-is-now</span><span style="color:#D4D4D4;"> = 1 </span></span>
<span class="line"><span style="color:#6A9955;">#把SYSDATE 函数编程为 NOW的别名</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">#*** 系统资源相关选项 ***#</span></span>
<span class="line"><span style="color:#569CD6;">back_log</span><span style="color:#D4D4D4;"> = 50 </span></span>
<span class="line"><span style="color:#6A9955;">#接受队列，对于没建立 tcp 连接的请求队列放入缓存中，队列大小为 back_log，受限制与 OS 参数，试图设定 back_log 高于你的操作系统的限制将是无效的。默认值为 50。对于 Linux 系统推荐设置为小于512的整数。如果系统在一个短时间内有很多连接，则需要增大该参数的值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">max_connections</span><span style="color:#D4D4D4;"> = 1000 </span></span>
<span class="line"><span style="color:#6A9955;">#指定MySQL允许的最大连接进程数。如果在访问数据库时经常出现&quot;Too Many Connections&quot;的错误提 示，则需要增大该参数值。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">max_connect_errors</span><span style="color:#D4D4D4;"> = 10000 </span></span>
<span class="line"><span style="color:#6A9955;">#如果某个用户发起的连接 error 超过该数值，则该用户的下次连接将被阻塞，直到管理员执行 flush hosts ; 命令或者服务重启， 防止黑客 ， 非法的密码以及其他在链接时的错误会增加此值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">open_files_limit</span><span style="color:#D4D4D4;"> = 10240 </span></span>
<span class="line"><span style="color:#6A9955;">#MySQL打开的文件描述符限制，默认最小1024;当open_files_limit没有被配置的时候，比较max_connections*5和ulimit-n的值，哪个大用哪个，当open_file_limit被配置的时候，比较open_files_limit和max_connections*5的值，哪个大用哪个。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">connect-timeout</span><span style="color:#D4D4D4;"> = 10 </span></span>
<span class="line"><span style="color:#6A9955;">#连接超时之前的最大秒数,在 Linux 平台上，该超时也用作等待服务器首次回应的时间</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">wait-timeout</span><span style="color:#D4D4D4;"> = 28800 </span></span>
<span class="line"><span style="color:#6A9955;">#等待关闭连接的时间</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">interactive-timeout</span><span style="color:#D4D4D4;"> = 28800 </span></span>
<span class="line"><span style="color:#6A9955;">#关闭连接之前，允许 interactive_timeout（取代了wait_timeout）秒的不活动时间。客户端的会话 wait_timeout 变量被设为会话interactive_timeout 变量的值。如果前端程序采用短连接，建议缩短这2个值, 如果前端程序采用长连接，可直接注释掉这两个选项，默认配置(8小时)  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">slave-net-timeout</span><span style="color:#D4D4D4;"> = 600 </span></span>
<span class="line"><span style="color:#6A9955;">#从服务器也能够处理网络连接中断。但是，只有从服务器超过slave_net_timeout 秒没有从主服务器收到数据才通知网络中断</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">net_read_timeout</span><span style="color:#D4D4D4;"> = 30 </span></span>
<span class="line"><span style="color:#6A9955;">#从服务器读取信息的超时</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">net_write_timeout</span><span style="color:#D4D4D4;"> = 60 </span></span>
<span class="line"><span style="color:#6A9955;">#从服务器写入信息的超时</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">net_retry_count</span><span style="color:#D4D4D4;"> = 10 </span></span>
<span class="line"><span style="color:#6A9955;">#如果某个通信端口的读操作中断了，在放弃前重试多次</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">net_buffer_length</span><span style="color:#D4D4D4;"> = 16384 </span></span>
<span class="line"><span style="color:#6A9955;">#包消息缓冲区初始化为 net_buffer_length 字节，但需要时可以增长到 max_allowed_packet 字节</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">max_allowed_packet</span><span style="color:#D4D4D4;"> = 64M</span></span>
<span class="line"><span style="color:#6A9955;"># 服务所能处理的请求包的最大大小以及服务所能处理的最大的请求大小(当与大的BLOB 字段一起工作时相当必要)， 每个连接独立的大小.大小动态增加。 设置最大包,限制server接受的数据包大小，避免超长SQL的执行有问题 默认值为16M，当MySQL客户端或mysqld</span></span>
<span class="line"><span style="color:#D4D4D4;">服务器收到大于 max_allowed_packet 字节的信息包时，将发出“信息包过大”错误，并关闭连接。对于某些客户端，如果通信信息包过大，在执行查询期间，可能会遇到“丢失与 MySQL 服务器的连接”错误。默认值 16M。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">table_cache</span><span style="color:#D4D4D4;"> = 512 </span></span>
<span class="line"><span style="color:#6A9955;"># 所有线程所打开表的数量. 增加此值就增加了mysqld所需要的文件描述符的数量这样你需要确认在[mysqld_safe]中 “open-files-limit” 变量设置打开文件数量允许至少4096</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">thread_stack</span><span style="color:#D4D4D4;"> = 192K </span></span>
<span class="line"><span style="color:#6A9955;"># 线程使用的堆大小. 此容量的内存在每次连接时被预留.MySQL 本身常不会需要超过 64K 的内存如果你使用你自己的需要大量堆的 UDF 函数或者你的操作系统对于某些操作需要更多的堆,你也许需要将其设置的更高一点.默认设置足以满足大多数应用</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">thread_cache_size</span><span style="color:#D4D4D4;"> = 20 </span></span>
<span class="line"><span style="color:#6A9955;"># 我们在 cache 中保留多少线程用于重用.当一个客户端断开连接后,如果 cache 中的线程还少于 thread_cache_size,则客户端线程被放入 cache 中.这可以在你需要大量新连接的时候极大的减少线程创建的开销(一般来说如果你有好的线程模型的话,</span></span>
<span class="line"><span style="color:#D4D4D4;">这不会有明显的性能提升.)服务器线程缓存这个值表示可以重新利用保存在缓存中线程的数量,当断开连接时如果缓存中还有空间,那么客户端的线程将被放到缓存中,如果线程重新被请求，那么请求将从缓存中读取,如果缓存中是空的或者是新的请求，那么这个线程将被重新创建,</span></span>
<span class="line"><span style="color:#D4D4D4;">如果有很多新的线程，增加这个值可以改善系统性能.通过比较 Connections 和 Threads_created 状态的变量，可以看到这个变量的作用</span></span>
<span class="line"><span style="color:#D4D4D4;">根据物理内存设置规则如下：</span></span>
<span class="line"><span style="color:#D4D4D4;">1G  —&gt; 8</span></span>
<span class="line"><span style="color:#D4D4D4;">2G  —&gt; 16</span></span>
<span class="line"><span style="color:#D4D4D4;">3G  —&gt; 32</span></span>
<span class="line"><span style="color:#D4D4D4;">大于3G  —&gt; 64</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">thread_concurrency</span><span style="color:#D4D4D4;"> = 8 </span></span>
<span class="line"><span style="color:#6A9955;">#此允许应用程序给予线程系统一个提示在同一时间给予渴望被运行的线程的数量.该参数取值为服务器逻辑CPU数量×2，在本例中，服务器有 2 颗物理CPU，而每颗物理CPU又支持H.T超线程，所以实际取值为 4 × 2 ＝ 8.设置 thread_concurrency的值的正确与否, </span></span>
<span class="line"><span style="color:#D4D4D4;">对 mysql 的性能影响很大, 在多个 cpu(或多核)的情况下，错误设置了 thread_concurrency 的值, 会导致 mysql 不能充分利用多 cpu(或多核),出现同一时刻只能一个 cpu(或核)在工作的情况。 thread_concurrency 应设为 CPU 核数的 2 倍.比如有一个双核的 CPU, </span></span>
<span class="line"><span style="color:#D4D4D4;">那么 thread_concurrency 的应该为 4</span><span style="color:#6A9955;">; 2 个双核的 cpu,thread_concurrency 的值应为 8,属重点优化参数</span></span>
<span class="line"><span style="color:#D4D4D4;"> </span></span>
<span class="line"><span style="color:#D4D4D4;"> </span></span>
<span class="line"><span style="color:#6A9955;">#*** qcache settings 相关选项 ***#</span></span>
<span class="line"><span style="color:#569CD6;">query_cache_limit</span><span style="color:#D4D4D4;"> = 2M </span></span>
<span class="line"><span style="color:#6A9955;">#不缓存查询大于该值的结果.只有小于此设定值的结果才会被缓冲,  此设置用来保护查询缓冲,防止一个极大的结果集将其他所有的查询结果都覆盖.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">query_cache_min_res_unit</span><span style="color:#D4D4D4;"> = 2K </span></span>
<span class="line"><span style="color:#6A9955;">#查询缓存分配的最小块大小.默认是 4KB，设置值大对大数据查询有好处，但如果你的查询都是小数据查询，就容易造成内存碎片和浪费</span></span>
<span class="line"><span style="color:#D4D4D4;">查询缓存碎片率 = Qcache_free_blocks / Qcache_total_blocks * 100%</span></span>
<span class="line"><span style="color:#D4D4D4;">如果查询缓存碎片率超过 20%，可以用 FLUSH QUERY CACHE 整理缓存碎片，或者试试减小query_cache_min_res_unit，如果你的查询都是小数据量的话。</span></span>
<span class="line"><span style="color:#D4D4D4;">查询缓存利用率 = (query_cache_size – Qcache_free_memory) / query_cache_size *100%</span></span>
<span class="line"><span style="color:#D4D4D4;">查询缓存利用率在 25%以下的话说明 query_cache_size 设置的过大，可适当减小</span><span style="color:#6A9955;">;查询缓存利用率在 80%以上而且 Qcache_lowmem_prunes &gt; 50 的话说明 query_cache_size 可能有点小，要不就是碎片太多。</span></span>
<span class="line"><span style="color:#D4D4D4;">查询缓存命中率 = (Qcache_hits – Qcache_inserts) / Qcache_hits * 100%</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">query_cache_size</span><span style="color:#D4D4D4;"> = 64M  </span></span>
<span class="line"><span style="color:#6A9955;">#指定 MySQL 查询缓冲区的大小。可以通过在 MySQL 控制台执行以下命令观察：</span></span>
<span class="line"><span style="color:#D4D4D4;">代码:</span></span>
<span class="line"><span style="color:#D4D4D4;">&gt; SHOW VARIABLES LIKE </span><span style="color:#CE9178;">&#39;%query_cache%&#39;</span><span style="color:#6A9955;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">&gt; SHOW STATUS LIKE </span><span style="color:#CE9178;">&#39;Qcache%&#39;</span><span style="color:#6A9955;">;如果 Qcache_lowmem_prunes 的值非常大，则表明经常出现缓冲不够的情况；</span></span>
<span class="line"><span style="color:#D4D4D4;">如果 Qcache_hits 的值非常大，则表明查询缓冲使用非常频繁，如果该值较小反而会影响效率，那么可以考虑不用查询缓冲； Qcache_free_blocks，如果该值非常大，则表明缓冲区中碎片很多。</span></span>
<span class="line"><span style="color:#D4D4D4;">memlock </span><span style="color:#6A9955;"># 如果你的系统支持 memlock() 函数,你也许希望打开此选项用以让运行中的 mysql 在在内存高度</span></span>
<span class="line"><span style="color:#D4D4D4;">紧张的时候,数据在内存中保持锁定并且防止可能被 swapping out,此选项对于性能有益</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">#*** default settings 相关选项 ***#</span></span>
<span class="line"><span style="color:#569CD6;">default_table_type</span><span style="color:#D4D4D4;"> = InnoDB </span></span>
<span class="line"><span style="color:#6A9955;"># 当创建新表时作为默认使用的表类型,如果在创建表示没有特别执行表类型,将会使用此值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">default-time-zone</span><span style="color:#D4D4D4;"> = system </span></span>
<span class="line"><span style="color:#6A9955;">#服务器时区</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">character-set-server</span><span style="color:#D4D4D4;"> = utf8 </span></span>
<span class="line"><span style="color:#6A9955;">#server 级别字符集</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">default-storage-engine</span><span style="color:#D4D4D4;"> = InnoDB </span></span>
<span class="line"><span style="color:#6A9955;">#默认存储引擎</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">#*** tmp &amp;&amp; heap settings 相关选项 ***#</span></span>
<span class="line"><span style="color:#569CD6;">tmp_table_size</span><span style="color:#D4D4D4;"> = 512M </span></span>
<span class="line"><span style="color:#6A9955;">#临时表的最大大小，如果超过该值，则结果放到磁盘中,此限制是针对单个表的,而不是总和.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">max_heap_table_size</span><span style="color:#D4D4D4;"> = 512M </span></span>
<span class="line"><span style="color:#6A9955;">#独立的内存表所允许的最大容量.此选项为了防止意外创建一个超大的内存表导致永尽所有的内存资源.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">#*** log settings 相关选项 ***#</span></span>
<span class="line"><span style="color:#569CD6;">log-bin</span><span style="color:#D4D4D4;"> = mysql-bin </span></span>
<span class="line"><span style="color:#6A9955;">#打开二进制日志功能.在复制(replication)配置中,作为 MASTER 主服务器必须打开此项.如果你需要从你最后的备份中做基于时间点的恢复,你也同样需要二进制日志.这些路径相对于 datadir</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">log_slave_updates</span><span style="color:#D4D4D4;"> = 1 </span></span>
<span class="line"><span style="color:#6A9955;">#表示slave将复制事件写进自己的二进制日志</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">log-bin-index</span><span style="color:#D4D4D4;"> = mysql-bin.index </span></span>
<span class="line"><span style="color:#6A9955;">#二进制的索引文件名</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">relay-log</span><span style="color:#D4D4D4;"> = relay-log </span></span>
<span class="line"><span style="color:#6A9955;">#定义relay_log的位置和名称，如果值为空，则默认位置在数据文件的目录，文件名为host_name-relay-bin.nnnnnn（By default, relay log file names have the form host_name-relay-bin.nnnnnn in the data directory）；</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">relay_log_index</span><span style="color:#D4D4D4;"> = relay-log.index  </span></span>
<span class="line"><span style="color:#6A9955;">#relay-log的索引文件名</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">log-warnings</span><span style="color:#D4D4D4;"> = 1 </span></span>
<span class="line"><span style="color:#6A9955;"># 将警告打印输出到错误 log 文件.如果你对于MySQL有任何问题，你应该打开警告 log 并且仔细审查错误日志,查出可能的原因.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">log-error</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/log/mysql.err </span></span>
<span class="line"><span style="color:#6A9955;">#错误日志路径</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">log_output</span><span style="color:#D4D4D4;"> = FILE </span></span>
<span class="line"><span style="color:#6A9955;">#参数 log_output 指定了慢查询输出的格式，默认为 FILE，你可以将它设为 TABLE，然后就可以查询 mysql 架构下的 slow_log 表了</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">log_slow_queries </span></span>
<span class="line"><span style="color:#6A9955;">#指定是否开启慢查询日志(该参数要被slow_query_log取代，做兼容性保留)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">slow_query_log</span><span style="color:#D4D4D4;"> = 1 </span></span>
<span class="line"><span style="color:#6A9955;"># 指定是否开启慢查询日志. 慢查询是指消耗了比 “long_query_time” 定义的更多时间的查询.如果 log_long_format 被打开,那些没有使用索引的查询也会被记录.如果你经常增加新查询到已有的系统内的话. 一般来说这是一个好主意,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">long-query-time</span><span style="color:#D4D4D4;"> = 1 </span></span>
<span class="line"><span style="color:#6A9955;">#设定慢查询的阀值，超出次设定值的SQL即被记录到慢查询日志，缺省值为10s.所有的使用了比这个时间(以秒为单位)更多的查询会被认为是慢速查询.不要在这里使用”1″, 否则会导致所有的查询,甚至非常快的查询页被记录下来(由于MySQL 目前时间的精确度只能达到秒的级别).</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">log_long_format </span></span>
<span class="line"><span style="color:#6A9955;"># 在慢速日志中记录更多的信息.一般此项最好打开，打开此项会记录使得那些没有使用索引的查询也被作为到慢速查询附加到慢速日志里</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">slow_query_log_file</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/log/slow.log </span></span>
<span class="line"><span style="color:#6A9955;"># 指定慢日志文件存放位置，可以为空，系统会给一个缺省的文件host_name-slow.log</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">log-queries-not-using-indexes </span></span>
<span class="line"><span style="color:#6A9955;">#如果运行的SQL语句没有使用索引，则mysql数据库同样会将这条SQL语句记录到慢查询日志文件中。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">min_examined_row_limit</span><span style="color:#D4D4D4;">=1000　　　　</span></span>
<span class="line"><span style="color:#6A9955;">#记录那些由于查找了多余1000次而引发的慢查询</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">long-slow-admin-statements　　　　</span></span>
<span class="line"><span style="color:#6A9955;">#记录那些慢的optimize table，analyze table和alter table语句</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">log-slow-slave-statements </span></span>
<span class="line"><span style="color:#6A9955;">#记录由Slave所产生的慢查询</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">general_log</span><span style="color:#D4D4D4;"> = 1 </span></span>
<span class="line"><span style="color:#6A9955;">#将所有到达MySQL Server的SQL语句记录下来,默认关闭 </span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">general_log_file</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/log/mysql.log </span></span>
<span class="line"><span style="color:#6A9955;">#general_log路径</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">max_binlog_size</span><span style="color:#D4D4D4;"> = 1G </span></span>
<span class="line"><span style="color:#6A9955;">#如果二进制日志写入的内容超出给定值，日志就会发生滚动。你不能将该变量设置为大于1GB或小于4096字节。 默认值是1GB。如果你正使用大的事务，二进制日志还会超过max_binlog_size</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">max_relay_log_size</span><span style="color:#D4D4D4;"> = 1G </span></span>
<span class="line"><span style="color:#6A9955;">#标记relaylog允许的最大值，如果该值为0，则默认值为max_binlog_size(1G)；如果不为0，则max_relay_log_size则为最大的relay_log文件大小；</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">relay-log-purge</span><span style="color:#D4D4D4;"> = 1 </span></span>
<span class="line"><span style="color:#6A9955;">#是否自动清空不再需要中继日志时。默认值为1(启用)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">expire_logs_days</span><span style="color:#D4D4D4;"> = 30 </span></span>
<span class="line"><span style="color:#6A9955;">#超过 30 天的 binlog 删除</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">binlog_cache_size</span><span style="color:#D4D4D4;"> = 1M </span></span>
<span class="line"><span style="color:#6A9955;"># 在一个事务中 binlog 为了记录 SQL 状态所持有的 cache 大小,如果你经常使用大的,多声明的事务,你可以增加此值来获取更大的性能.所有从事务来的状态都将被缓冲在 binlog 缓冲中然后在提交后一次性写入到 binlog 中,如果事务比此值大, 会使用磁盘上的临时文件来替代.此缓冲在每个连接的事务第一次更新状态时被创建.session 级别</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">replicate-wild-ignore-table</span><span style="color:#D4D4D4;"> = mysql.% </span></span>
<span class="line"><span style="color:#6A9955;">#复制时忽略数据库及表</span></span>
<span class="line"><span style="color:#569CD6;">slave_skip_errors</span><span style="color:#D4D4D4;">=all </span></span>
<span class="line"><span style="color:#6A9955;">#定义复制过程中从服务器可以自动跳过的错误号，当复制过程中遇到定义的错误号，就可以自动跳过，直接执行后面的SQL语句。</span></span>
<span class="line"><span style="color:#D4D4D4;">slave_skip_errors选项有四个可用值，分别为：off，all，ErorCode，ddl_exist_errors。</span></span>
<span class="line"><span style="color:#D4D4D4;">  默认情况下该参数值是off，我们可以列出具体的error code，也可以选择all，mysql5.6及MySQL Cluster NDB 7.3以及后续版本增加了参数ddl_exist_errors，该参数包含一系列error code（1007,1008,1050,1051,1054,1060,1061,1068,1094,1146）</span></span>
<span class="line"><span style="color:#D4D4D4;">    一些error code代表的错误如下：</span></span>
<span class="line"><span style="color:#D4D4D4;">    1007：数据库已存在，创建数据库失败</span></span>
<span class="line"><span style="color:#D4D4D4;">    1008：数据库不存在，删除数据库失败</span></span>
<span class="line"><span style="color:#D4D4D4;">    1050：数据表已存在，创建数据表失败</span></span>
<span class="line"><span style="color:#D4D4D4;">    1051：数据表不存在，删除数据表失败</span></span>
<span class="line"><span style="color:#D4D4D4;">    1054：字段不存在，或程序文件跟数据库有冲突</span></span>
<span class="line"><span style="color:#D4D4D4;">    1060：字段重复，导致无法插入</span></span>
<span class="line"><span style="color:#D4D4D4;">    1061：重复键名</span></span>
<span class="line"><span style="color:#D4D4D4;">    1068：定义了多个主键</span></span>
<span class="line"><span style="color:#D4D4D4;">    1094：位置线程ID</span></span>
<span class="line"><span style="color:#D4D4D4;">    1146：数据表缺失，请恢复数据库</span></span>
<span class="line"><span style="color:#D4D4D4;">    1053：复制过程中主服务器宕机</span></span>
<span class="line"><span style="color:#D4D4D4;">    1062：主键冲突 Duplicate entry </span><span style="color:#CE9178;">&#39;%s&#39;</span><span style="color:#D4D4D4;"> for key %d</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#6A9955;">#*** MyISAM 相关选项 ***#</span></span>
<span class="line"><span style="color:#569CD6;">key_buffer_size</span><span style="color:#D4D4D4;"> = 256M </span></span>
<span class="line"><span style="color:#6A9955;">#指定用于索引的缓冲区大小，增加它可得到更好的索引处理性能。如果是以InnoDB引擎为主的DB，专用于MyISAM引擎的 key_buffer_size 可以设置较小，8MB 已足够  如果是以MyISAM引擎为主，可设置较大，但不能超过4G. 在这里，强烈建议不使用MyISAM引擎，默认都是用InnoDB引擎.注意：该参数值设置的过大反而会是服务器整体效率降低！</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">sort_buffer_size</span><span style="color:#D4D4D4;"> = 2M </span></span>
<span class="line"><span style="color:#6A9955;">#查询排序时所能使用的缓冲区大小。排序缓冲被用来处理类似 ORDER BY 以及 GROUP BY 队列所引起的排序.一个用来替代的基于磁盘的合并分类会被使用.查看 “Sort_merge_passes” 状态变量. 在排序发生时由每个线程分配 注意：该参数对应的分配内存是每连接独占！如果有 100 个连接，那么实际分配的总共排序缓冲区大小为 100 × 6 ＝600MB,所以,对于内存在 4GB 左右的服务器推荐设置为 6-8M。 </span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">read_buffer_size</span><span style="color:#D4D4D4;"> = 2M </span></span>
<span class="line"><span style="color:#6A9955;">#读查询操作所能使用的缓冲区大小。和 sort_buffer_size 一样，该参数对应的分配内存也是每连接独享！用来做 MyISAM 表全表扫描的缓冲大小.当全表扫描需要时,在对应线程中分配.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">join_buffer_size</span><span style="color:#D4D4D4;"> = 8M </span></span>
<span class="line"><span style="color:#6A9955;">#联合查询操作所能使用的缓冲区大小，和 sort_buffer_size 一样，该参数对应的分配内存也是每连接独享!此缓冲被使用来优化全联合(full JOINs 不带索引的联合).类似的联合在极大多数情况下有非常糟糕的性能表现, 但是将此值设大能够减轻性能影响.通过 “Select_full_join”状态变量查看全联合的数量， 当全联合发生时,在每个线程中分配。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">read_rnd_buffer_size</span><span style="color:#D4D4D4;"> = 8M </span></span>
<span class="line"><span style="color:#6A9955;">#MyISAM 以索引扫描(Random Scan)方式扫描数据的 buffer大小 </span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">bulk_insert_buffer_size</span><span style="color:#D4D4D4;"> = 64M </span></span>
<span class="line"><span style="color:#6A9955;">#MyISAM 使用特殊的类似树的 cache 来使得突发插入(这些插入是,INSERT … SELECT, INSERT … VALUES (…), (…), …, 以及 LOAD DATAINFILE) 更快. 此变量限制每个进程中缓冲树的字节数.设置为 0 会关闭此优化.为了最优化不要将此值设置大于 “key_buffer_size”.当突发插入被检测到时此缓冲将被分配MyISAM 用在块插入优化中的树缓冲区的大小。注释：这是一个 per thread 的限制 （ bulk 大量）.此缓冲当 MySQL 需要在 REPAIR, OPTIMIZE, ALTER 以及 LOAD DATA INFILE到一个空表中引起重建索引时被分配.这在每个线程中被分配.所以在设置大值时需要小心.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">myisam_sort_buffer_size</span><span style="color:#D4D4D4;"> = 64M </span></span>
<span class="line"><span style="color:#6A9955;">#MyISAM 设置恢复表之时使用的缓冲区的尺寸,当在REPAIR TABLE 或用 CREATE INDEX 创建索引或 ALTER TABLE 过程中排序 MyISAM 索引分配的缓冲区</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">myisam_max_sort_file_size</span><span style="color:#D4D4D4;"> = 10G</span></span>
<span class="line"><span style="color:#6A9955;">#mysql重建索引时允许使用的临时文件最大大小</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">myisam_repair_threads</span><span style="color:#D4D4D4;"> = 1 </span></span>
<span class="line"><span style="color:#6A9955;">#如果该值大于 1，在 Repair by sorting 过程中并行创建MyISAM 表索引(每个索引在自己的线程内).如果一个表拥有超过一个索引, MyISAM 可以通过并行排序使用超过一个线程去修复他们.这对于拥有多个 CPU 以及大量内存情况的用户,是一个很好的选择.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">myisam_recover</span><span style="color:#D4D4D4;"> = 64K</span></span>
<span class="line"><span style="color:#6A9955;">#允许的 GROUP_CONCAT()函数结果的最大长度</span></span>
<span class="line"><span style="color:#569CD6;">transaction_isolation</span><span style="color:#D4D4D4;"> = REPEATABLE-READ </span><span style="color:#6A9955;"># 设定默认的事务隔离级别.可用的级别如下:READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ,SERIALIZABLE</span></span>
<span class="line"><span style="color:#D4D4D4;">1.READ UNCOMMITTED-读未提交 2.READ COMMITTE-读已提交 3.REPEATABLE READ -可重复读 4.SERIALIZABLE -串行</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># *** INNODB 相关选项 ***#</span></span>
<span class="line"><span style="color:#D4D4D4;">skip-innodb </span></span>
<span class="line"><span style="color:#6A9955;"># 如果你的 MySQL 服务包含 InnoDB 支持但是并不打算使用的话,使用此选项会节省内存以及磁盘空间,并且加速某些部分</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_file_per_table</span><span style="color:#D4D4D4;"> = 1 </span></span>
<span class="line"><span style="color:#6A9955;"># InnoDB为独立表空间模式，每个数据库的每个表都会生成一个数据空间</span></span>
<span class="line"><span style="color:#D4D4D4;">独立表空间优点：</span></span>
<span class="line"><span style="color:#D4D4D4;">1．每个表都有自已独立的表空间。</span></span>
<span class="line"><span style="color:#D4D4D4;">2．每个表的数据和索引都会存在自已的表空间中。</span></span>
<span class="line"><span style="color:#D4D4D4;">3．可以实现单表在不同的数据库中移动。</span></span>
<span class="line"><span style="color:#D4D4D4;">4．空间可以回收（除drop table操作处，表空不能自已回收）</span></span>
<span class="line"><span style="color:#D4D4D4;">缺点：</span></span>
<span class="line"><span style="color:#D4D4D4;">1.单表增加过大，如超过100G</span></span>
<span class="line"><span style="color:#D4D4D4;">结论：</span></span>
<span class="line"><span style="color:#D4D4D4;">共享表空间在Insert操作上少有优势。其它都没独立表空间表现好。当启用独立表空间时，请合理调整：innodb_open_files</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_status_file</span><span style="color:#D4D4D4;"> = 1 </span></span>
<span class="line"><span style="color:#6A9955;">#启用InnoDB的status file，便于管理员查看以及监控等</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_open_files</span><span style="color:#D4D4D4;"> = 2048 </span></span>
<span class="line"><span style="color:#6A9955;"># 限制Innodb能打开的表的数据，如果库里的表特别多的情况，请增加这个。这个值默认是300</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_additional_mem_pool_size</span><span style="color:#D4D4D4;"> = 100M </span></span>
<span class="line"><span style="color:#6A9955;">#设置InnoDB存储引擎用来存放数据字典信息以及一些内部数据结构的内存空间大小，所以当我们一个MySQL Instance中的数据库对象非常多的时候，是需要适当调整该参数的大小以确保所有数据都能存放在内存中提高访问效率的。 </span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_buffer_pool_size</span><span style="color:#D4D4D4;"> = 2G </span></span>
<span class="line"><span style="color:#6A9955;">#包括数据页、索引页、插入缓存、锁信息、自适应哈希所以、数据字典信息.InnoDB 使用一个缓冲池来保存索引和原始数据, 不像 MyISAM.这里你设置越大,你在存取表里面数据时所需要的磁盘 I/O 越少.在一个独立使用的数据库服务器上,你可以设置这个变量到服务器物理内存大小的 80%,不要设置过大,否则,由于物理内存的竞争可能导致操作系统的换页颠簸.注意在 32 位系统上你每个进程可能被限制在 2-3.5G 用户层面内存限制,所以不要设置的太高.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_write_io_threads</span><span style="color:#D4D4D4;"> = 4</span></span>
<span class="line"><span style="color:#569CD6;">innodb_read_io_threads</span><span style="color:#D4D4D4;"> = 4</span></span>
<span class="line"><span style="color:#6A9955;"># innodb使用后台线程处理数据页上的读写 I/O(输入输出)请求,根据你的 CPU 核数来更改,默认是4</span></span>
<span class="line"><span style="color:#6A9955;"># 注:这两个参数不支持动态改变,需要把该参数加入到my.cnf里，修改完后重启MySQL服务,允许值的范围从 1-64</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_data_home_dir</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/var/ </span></span>
<span class="line"><span style="color:#6A9955;">#设置此选项如果你希望 InnoDB 表空间文件被保存在其他分区.默认保存在 MySQL 的 datadir 中.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_data_file_path</span><span style="color:#D4D4D4;"> = ibdata1:500M</span><span style="color:#6A9955;">;ibdata2:2210M:autoextend</span></span>
<span class="line"><span style="color:#6A9955;">#InnoDB将数据保存在一个或者多个数据文件中成为表空间.如果你只有单个逻辑驱动保存你的数据,一个单个的自增文件就足够好了.其他情况下.每个设备一个文件一般都是个好的选择.你也可以配置 InnoDB 来使用裸盘分区 – 请参考手册来获取更多相关内容</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_file_io_threads</span><span style="color:#D4D4D4;"> = 4 </span></span>
<span class="line"><span style="color:#6A9955;">#用来同步 IO 操作的 IO 线程的数量. 此值在 Unix 下被硬编码为 4,但是在 Windows 磁盘 I/O 可能在一个大数值下表现的更好.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_thread_concurrency</span><span style="color:#D4D4D4;"> = 16</span></span>
<span class="line"><span style="color:#6A9955;">#在 InnoDb 核心内的允许线程数量,InnoDB 试着在 InnoDB 内保持操作系统线程的数量少于或等于这个参数给出的限制,最优值依赖于应用程序,硬件以及操作系统的调度方式.过高的值可能导致线程的互斥颠簸.默认设置为 0,表示不限制并发数，这里推荐设置为0，更好去发挥CPU多核处理能力，提高并发量</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_flush_log_at_trx_commit</span><span style="color:#D4D4D4;"> = 1 </span></span>
<span class="line"><span style="color:#6A9955;">#如果设置为 1 ,InnoDB 会在每次提交后刷新(fsync)事务日志到磁盘上,这提供了完整的 ACID 行为.如果你愿意对事务安全折衷, 并且你正在运行一个小的食物, 你可以设置此值到 0 或者 2 来减少由事务日志引起的磁盘 I/O</span></span>
<span class="line"><span style="color:#D4D4D4;">代表日志只大约每秒写入日志文件并且日志文件刷新到磁盘.</span></span>
<span class="line"><span style="color:#D4D4D4;">代表日志写入日志文件在每次提交后,但是日志文件只有大约每秒才会刷新到磁盘上.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_log_buffer_size</span><span style="color:#D4D4D4;"> = 8M </span></span>
<span class="line"><span style="color:#6A9955;">#用来缓冲日志数据的缓冲区的大小.当此值快满时, InnoDB 将必须刷新数据到磁盘上.由于基本上每秒都会刷新一次,所以没有必要将此值设置的太大(甚至对于长事务而言)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_log_file_size</span><span style="color:#D4D4D4;"> = 500M </span></span>
<span class="line"><span style="color:#6A9955;">#事物日志大小.在日志组中每个日志文件的大小，你应该设置日志文件总合大小到你缓冲池大小的5%~100%，来避免在日志文件覆写上不必要的缓冲池刷新行为.不论如何, 请注意一个大的日志文件大小会增加恢复进程所需要的时间.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_log_files_in_group</span><span style="color:#D4D4D4;"> = 2 </span></span>
<span class="line"><span style="color:#6A9955;">#在日志组中的文件总数.通常来说 2~3 是比较好的.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_log_group_home_dir</span><span style="color:#D4D4D4;"> =  /usr/local/mysql/var/</span></span>
<span class="line"><span style="color:#6A9955;"># InnoDB 的日志文件所在位置. 默认是 MySQL 的 datadir.你可以将其指定到一个独立的硬盘上或者一个 RAID1 卷上来提高其性能innodb_max_dirty_pages_pct = 90 #innodb 主线程刷新缓存池中的数据，使脏数据比例小于 90%,这是一个软限制,不被保证绝对执行.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_lock_wait_timeout</span><span style="color:#D4D4D4;"> = 50 </span></span>
<span class="line"><span style="color:#6A9955;">#InnoDB 事务在被回滚之前可以等待一个锁定的超时秒数。InnoDB 在它自己的 锁定表中自动检测事务死锁并且回滚事务。 InnoDB 用 LOCK TABLES 语句注意到锁定设置。默认值是 50 秒</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_flush_method</span><span style="color:#D4D4D4;"> = O_DSYNC </span></span>
<span class="line"><span style="color:#6A9955;"># InnoDB 用来刷新日志的方法.表空间总是使用双重写入刷新方法.默认值是 “fdatasync”, 另一个是 “O_DSYNC”.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">innodb_force_recovery</span><span style="color:#D4D4D4;">=1</span></span>
<span class="line"><span style="color:#6A9955;"># 如果你发现 InnoDB 表空间损坏, 设置此值为一个非零值可能帮助你导出你的表.从1 开始并且增加此值知道你能够成功的导出表.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">innodb_fast_shutdown </span></span>
<span class="line"><span style="color:#6A9955;"># 加速 InnoDB 的关闭. 这会阻止 InnoDB 在关闭时做全清除以及插入缓冲合并.这可能极大增加关机时间, 但是取而代之的是 InnoDB 可能在下次启动时做这些操作.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># *** 其他 相关选项 ***#</span></span>
<span class="line"><span style="color:#D4D4D4;">[mysqldump]</span></span>
<span class="line"><span style="color:#D4D4D4;">quick </span></span>
<span class="line"><span style="color:#6A9955;">#支持较大数据库的转储，在导出非常巨大的表时需要此项。增加该变量的值十分安全，这是因为仅当需要时才会分配额外内存。例如，仅当你发出长查询或mysqld必须返回大的结果行时mysqld才会分配更多内存。该变量之所以取较小默认值是一种预防措施，以捕获客户端和服务器之间的错误信息包，并确保不会因偶然使用大的信息包而导致内存溢出。 如果你正是用大的BLOB值，而且未为mysqld授予为处理查询而访问足够内存的权限，也会遇到与大信息包有关的奇怪问题。如果怀疑出现了该情况，请尝试在mysqld_safe脚本开始增加ulimit -d 256000，并重启mysqld。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">[mysql]</span></span>
<span class="line"><span style="color:#D4D4D4;">auto-rehash </span></span>
<span class="line"><span style="color:#6A9955;">#允许通过 TAB 键提示</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">default-character-set</span><span style="color:#D4D4D4;"> = utf8 </span></span>
<span class="line"><span style="color:#6A9955;">#数据库字符集</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">connect-timeout</span><span style="color:#D4D4D4;"> = 3</span></span>
<span class="line"><span style="color:#D4D4D4;">[mysqld_safe]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">open-files-limit</span><span style="color:#D4D4D4;"> = 8192 </span></span>
<span class="line"><span style="color:#6A9955;">#增加每个进程的可打开文件数量.确认你已经将全系统限制设定的足够高!打开大量表需要将此值设大</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="逻辑架构" tabindex="-1"><a class="header-anchor" href="#逻辑架构" aria-hidden="true">#</a> 逻辑架构</h2><p>​ <img src="/db/mysql/mysql_construct.png" alt="逻辑架构图"></p><h2 id="存储引擎" tabindex="-1"><a class="header-anchor" href="#存储引擎" aria-hidden="true">#</a> 存储引擎</h2><p>【<strong>简介</strong>】</p><ul><li><p>每一个MySQL表主要由三部分组成：元数据、索引、数据。元数据即表定义等基本信息。</p></li><li><p>每一个<strong>MyISAM</strong>表，在对应的schema目录下，均对应三个同名的.frm, .MYI, .MYD文件。</p><p><img src="/db/mysql/mysql_myisam_file.png" alt="MyISAM表文件"></p></li></ul><p>说明：</p><p>可以通过在不同的数据库目录之间，自由移动上述三个文件，来实现MyISAM表的移动。</p><p>InnoDB表，无论表空间类型如何，均不具有自由移动性质。每一个<strong>InnoDB</strong>表，在对应的schema目录下，均对应一个同名.frm文件，此文件无实际意义。 全部表的元数据，都存放在系统表空间。 每个表的索引和数据，要么同时存放在共享的系统表空间，要么同时存放在各自的<strong>FILE_PER_TABLE</strong>表空间。</p><p>【<strong>系统表空间</strong>】</p><p>​ 组成：ibdata文件集合，如ibdata1，ibdata2等。</p><p>​ 位置：顶层数据目录。</p><p>​ 类型：全局共享，所有数据库的所有表共享ibdata文件。</p><p>​ 作用：存放全部表的元数据；作为undo log, change buffer, doublewrite buffer等的存储区；存放部分表的索引和数据。</p><p>【<strong>FILE_PER_TABLE(独立表空间)</strong>】</p><p>​ 组成：与该表同名的.ibd文件，如employee.ibd。</p><p>​ 位置：对应的schema目录</p><p>​ 类型：每个表有自己的表空间，每个表空间有自己的.ibd数据文件。</p><p>​ 作用：存放该表的索引和数据。</p><p>​ 特性：可以通过运行<em>RENAME TABLE db1.tbl_name TO db2.tbl_name</em>命令，实现<strong>FILE_PER_TABLE</strong>表在不同数据库之间的移动。</p><p><strong>关于系统表空间和独立表空间的说明</strong>：</p><ol><li><p>系统表空间和FILE_PER_TABLE表空间只服务于InnoDB类型的表，即ibdata1和.ibd文件为InnoDB所有；</p></li><li><p>当全局系统变量innodb_file_per_table = off时，新创建的表索引和数据，存放在系统表空间，即ibdata中；</p></li><li><p>当全局系统变量innodb_file_per_table = on时，创建新表时，会同时创建同名的.idb文件，用于存放该表的索引和数据。</p></li></ol><p>【<strong>重做日志</strong>】即innodb redo log，又名日志组。</p><p>​ 文件：ib_logfile文件集合，如ib_logfile0和ib_logfile1。</p><p>​ 位置：顶层数据目录。</p><p>​ 作用：所有需要修改InnoDB表数据的SQL语句和底层API调用，都被编码保存到重做日志。如果由于异常，导致数据更新没有同步到数据文件，如事物执行到一半发生崩溃，MySQL在重启时，将根据重做日志，将未完成的操作进行下去，以确保数据一致性。</p><p>​ <img src="/db/mysql/mysql_file_construct.png" alt="文件结构示例图"></p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">show engines;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>​ <img src="/db/mysql/mysql_engines.png" alt="存储引擎"></p><p><strong>InnoDB</strong></p><p><strong>MyISAM</strong></p><p><strong>对比关系图</strong></p><p>​ <img src="/db/mysql/mysql_engines_compare.jpg" alt="存储引擎对比关系图"></p><p><strong>Alisql+AliRedis</strong></p><h2 id="mysql-性能优化" tabindex="-1"><a class="header-anchor" href="#mysql-性能优化" aria-hidden="true">#</a> Mysql 性能优化</h2><h3 id="性能下降sql执行慢等待时间长" tabindex="-1"><a class="header-anchor" href="#性能下降sql执行慢等待时间长" aria-hidden="true">#</a> <strong>性能下降sql执行慢等待时间长</strong></h3><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">查询语句写的不好</span></span>
<span class="line"><span style="color:#D4D4D4;">索引失效</span></span>
<span class="line"><span style="color:#D4D4D4;">关联查询太多join(设计缺陷或者不得已的需求)</span></span>
<span class="line"><span style="color:#D4D4D4;">服务器调优及各个参数的设置(缓冲、线程池等)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="常见的join查询-详细信息" tabindex="-1"><a class="header-anchor" href="#常见的join查询-详细信息" aria-hidden="true">#</a> <strong>常见的join查询</strong> <a href="https://www.cnblogs.com/annsshadow/p/5037667.html" target="_blank" rel="noopener noreferrer">详细信息<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></h3><p><strong>mysql对sql语句解析顺序</strong></p><p><img src="/db/mysql/mysql_sql_explain.jpg" alt="sql语句解析"></p><p><strong>sql的执行顺序</strong></p><p><strong>join图</strong></p><p><strong>建表sql</strong></p><p><strong>7种join</strong></p><p><strong>索引: 没有特殊指定的使用Btree索引；Index帮助Mysql高效获取数据的数据结构。排好序的快速查找数据结构,除了本身的数据外，还管理另外一套方便查询的数据结构算法</strong></p><p><strong>唯一索引默认都是B+ tree索引</strong></p><p>存在问题：会影响查找和排序</p><p>mysql的索引分为<strong>单列索引</strong>(主键索引,唯一索引,普通索引)和<strong>组合索引</strong>.</p><p><strong>单列索引</strong>:一个索引只包含一个列,一个表可以有多个单列索引.</p><p><strong>组合索引</strong>:一个组合索引包含两个或两个以上的列,</p><p>单列索引：只使用一张表的某一个字段创建索引(idx_tableName_tableField)；</p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">create</span><span style="color:#D4D4D4;"> [UNIQUE 区别是不是唯一索引] </span><span style="color:#569CD6;">index</span><span style="color:#D4D4D4;"> idx_tableName_tableField </span><span style="color:#569CD6;">on</span><span style="color:#D4D4D4;"> tableName(tableField(</span><span style="color:#569CD6;">length</span><span style="color:#D4D4D4;">));</span></span>
<span class="line"><span style="color:#569CD6;">alter</span><span style="color:#D4D4D4;"> tabkeName </span><span style="color:#569CD6;">add</span><span style="color:#D4D4D4;"> [UNIQUE 区别是不是唯一索引] </span><span style="color:#569CD6;">index</span><span style="color:#D4D4D4;"> idx_tableName_tableField </span><span style="color:#569CD6;">on</span><span style="color:#D4D4D4;"> (tableField(</span><span style="color:#569CD6;">length</span><span style="color:#D4D4D4;">))</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>组合索引：只使用一张表的某一个字段创建索引(idx_tableName_tableField)；</p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">create</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">index</span><span style="color:#D4D4D4;"> idx_tableName_tableField </span><span style="color:#569CD6;">on</span><span style="color:#D4D4D4;"> tableName(tableField1,tableFiel2...);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>查看索引：</strong></p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">show </span><span style="color:#569CD6;">index</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">from</span><span style="color:#D4D4D4;"> tableName;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>删除索引</strong>：</p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">Drop</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">index</span><span style="color:#D4D4D4;"> indexName </span><span style="color:#569CD6;">on</span><span style="color:#D4D4D4;"> tableName;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>mysql索引结构：</strong></p><ol><li><strong>BTree索引</strong></li><li>Hash索引</li><li>full-text全文索引</li><li>R-Tree索引</li></ol><p><strong>使用索引的优点：</strong></p><ol><li>可以通过建立唯一索引或者主键索引,保证数据库表中每一行数据的唯一性.</li><li>建立索引可以大大提高检索的数据,以及减少表的检索行数</li><li>在表连接的连接条件 可以加速表与表直接的相连</li><li>在分组和排序字句进行数据检索,可以减少查询时间中 分组 和 排序时所消耗的时间(数据库的记录会重新排序)</li><li>建立索引,在查询中使用索引 可以提高性能</li></ol><p><strong>使用索引的缺点</strong>：</p><ol><li>在创建索引和维护索引 会耗费时间,随着数据量的增加而增加</li><li>索引文件会占用物理空间,除了数据表需要占用物理空间之外,每一个索引还会占用一定的物理空间</li><li>当对表的数据进行 INSERT,UPDATE,DELETE 的时候,索引也要动态的维护,这样就会降低数据的维护速度,(建立索引会占用磁盘空间的索引文件。一般情况这个问题不太严重，但如果你在一个大表上创建了多种组合索引，索引文件的会膨胀很快)。</li></ol><p><strong>使用索引需要注意的地方：</strong></p><ul><li>在经常需要搜索的列上,可以加快索引的速度</li><li>主键列上可以确保列的唯一性</li><li>在表与表的而连接条件上加上索引,可以加快连接查询的速度</li><li>在经常需要排序(order by),分组(group by)和的distinct 列上加索引 可以加快排序查询的时间, (单独order by 用不了索引，索引考虑加where 或加limit)</li><li>在一些where 之后的 &lt; &lt;= &gt; &gt;= BETWEEN IN 以及某个情况下的like 建立字段的索引(B-TREE)</li><li>like语句 如果你对nickname字段建立了一个索引.当查询的时候的语句是 nickname like &#39;%ABC%&#39; 那么这个索引讲不会起到作用.而nickname like &#39;ABC%&#39; 那么将可以用到索引</li><li>索引不会包含NULL列,如果列中包含NULL值都将不会被包含在索引中,复合索引中如果有一列含有NULL值那么这个组合索引都将失效,一般需要给默认值0或者 &#39; &#39;字符串</li><li>使用短索引,如果你的一个字段是Char(32)或者int(32),在创建索引的时候指定前缀长度 比如前10个字符 (前提是多数值是唯一的..)那么短索引可以提高查询速度,并且可以减少磁盘的空间,也可以减少I/0操作.</li><li>不要在列上进行运算,这样会使得mysql索引失效,也会进行全表扫描</li><li>选择越小的数据类型越好,因为通常越小的数据类型通常在磁盘,内存,cpu,缓存中 占用的空间很少,处理起来更快</li></ul><p><strong>什么情况下不创建索引：</strong></p><ul><li>查询中很少使用到的列 不应该创建索引,如果建立了索引然而还会降低mysql的性能和增大了空间需求.</li><li>很少数据的列也不应该建立索引,比如 一个性别字段 0或者1,在查询中,结果集的数据占了表中数据行的比例比较大,mysql需要扫描的行数很多,增加索引,并不能提高效率</li><li>定义为text和image和bit数据类型的列不应该增加索引,</li><li>当表的修改(UPDATE,INSERT,DELETE)操作远远大于检索(SELECT)操作时不应该创建索引,这两个操作是互斥的关系</li><li>重复且数量少的字段</li></ul><h3 id="性能分析" tabindex="-1"><a class="header-anchor" href="#性能分析" aria-hidden="true">#</a> 性能分析</h3><ol><li>mysql query optimizer (查询优化器)</li><li>常见瓶颈 <ul><li>cpu：cpu饱和一般发生在数据写入内存或从磁盘上读取数据的时候</li><li>io：装入的数据大于内存数据的时候</li><li>服务器硬件性能瓶颈：top,free,iostat和vmstat来查看系统性能状态</li></ul></li><li>explain执行计划</li></ol><p>​ explain：显示了mysql如何使用索引来处理select语句以及连接表。可以帮助选择更好的索引和写出更优化的查询语句。</p><p>​ 作用：</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">			1. 可以看到表的读取顺序</span></span>
<span class="line"><span style="color:#D4D4D4;">			2. 数据读取操作的操作类型</span></span>
<span class="line"><span style="color:#D4D4D4;">			3. 哪些索引可以被使用</span></span>
<span class="line"><span style="color:#D4D4D4;">			4. 哪些索引被实际使用</span></span>
<span class="line"><span style="color:#D4D4D4;">			5. 表之间的引用</span></span>
<span class="line"><span style="color:#D4D4D4;">			6. 每张表有多少行被优化器查询</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 怎样使用：</p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">			explain sql语句....;</span></span>
<span class="line"><span style="color:#D4D4D4;">			explain sql语句\G    #</span><span style="color:#569CD6;">key</span><span style="color:#D4D4D4;">-value键值对展示</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 使用之后包含的计划信息：</p><p>​ <img src="/db/mysql/mysql_explain_info.png" alt="explain 使用后的计划信息"></p><ol><li><p><strong>id</strong>*</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">select 查询的序列号，包含一组数字，表示查询中执行select子句或操作表的顺序。</span></span>
<span class="line"><span style="color:#D4D4D4;">1. id相同，执行顺序从上到下</span></span>
<span class="line"><span style="color:#D4D4D4;">2. id不同，如果是子查询，id的序号会递增，id越大优先级越高</span></span>
<span class="line"><span style="color:#D4D4D4;">3. id相同不同，同时存在</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>select_type</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. SIMPLE-&gt;简单的select查询，查询中不包含子查询或者union ;</span></span>
<span class="line"><span style="color:#D4D4D4;">2. PRIMARY-&gt;查询中包含任何复杂的子部分，最外层查询则被标记为primary=》复杂查询中最外层的 select **;**</span></span>
<span class="line"><span style="color:#D4D4D4;">3. SUBQUERY-&gt;在select 或 where列表中包含了子查询=》含在 select 中的子查询（不在 from 子句中）;子查询中的第一个SELECT.</span></span>
<span class="line"><span style="color:#D4D4D4;">4. DEPENDENT SUBQUERY-&gt;子查询中的第一个SELECT，取决于外面的查询   explain select **id** from t3 where **id** in (select **id** from t3 whereid=3952602 )  ;</span></span>
<span class="line"><span style="color:#D4D4D4;">5. DERIVED--衍生 在from列表中包含的子查询被标记为derived（衍生），mysql或递归执行这些子查询，把结果放在临时表里 explain select * from (select * from t3 where id=3952602) a ;</span></span>
<span class="line"><span style="color:#D4D4D4;">6. UNION--&gt;若第二个select出现在union之后，则被标记为union;若union包含在from子句的子查询中，外层select将被标记为derived. explain select * from t3 where id=3952602 union all select * from t3;</span></span>
<span class="line"><span style="color:#D4D4D4;">7. UNION RESULT--&gt;从 union 临时表检索结果t explain select * from t3 where id=3952602 union all select * from t3;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>table</strong>--&gt;一列表示 explain 的一行正在访问哪个表。</p></li><li><p><strong>type</strong>*--&gt;这列表示关联类型或访问类型，即MySQL决定如何查找表中的行。</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">最好到最差**system**&gt;**const**&gt;**eq_ref**&gt;**ref**&gt;**range**&gt;**index**&gt;**all**; **好的sql查询至少达到range级别，最好能达到ref**</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. **system**：表只有一行记录（等于系统表），这是const类型的特例，平时不会出现，可以忽略不计；</span></span>
<span class="line"><span style="color:#D4D4D4;">2. **const**：表示通过索引一次就找到了，const用于比较primary key 或者 unique索引。因为只需匹配一行数据，所有很快。如果将主键置于where列表中，mysql就能将该查询转换为一个const</span></span>
<span class="line"><span style="color:#D4D4D4;">3. **eq_ref**：唯一性索引扫描，对于每个索引键，表中只有一条记录与之匹配。常见于主键或 唯一索引扫描。</span></span>
<span class="line"><span style="color:#D4D4D4;">4. **ref**：相比 `eq_ref`，不使用唯一索引，而是使用普通索引或者唯一性索引的部分前缀，索引要和某个值相比较，可能会找到多个符合条件的行</span></span>
<span class="line"><span style="color:#D4D4D4;">5. **range**：范围扫描通常出现在 in(), between ,&gt; ,&lt;, &gt;= 等操作中。使用一个索引来检索给定范围的行。(范围之后的索引可能会失效)</span></span>
<span class="line"><span style="color:#D4D4D4;">6. **index**：Full Index Scan，index与ALL区别为index类型只遍历索引树。这通常为ALL块，应为索引文件通常比数据文件小。（Index与ALL虽然都是读全表，但index是从索引中读取，而ALL是从硬盘读取） </span></span>
<span class="line"><span style="color:#D4D4D4;">7. **ALL**：Full Table Scan，遍历全表以找到匹配的行 </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>possoble_keys</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">显示可能应用在这张表的索引一个或者多个；查询字段上存在索引，则该索引会被列出，但不一定被查询实际使用。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>key</strong>*</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">实际使用的索引。</span></span>
<span class="line"><span style="color:#D4D4D4;">如果为NULL，则没有使用索引，查询中若使用了覆盖索引，则该索引仅出现在key列表中;在possible_keys中可能没有索引，但是在key中有使用索引，说明可能使用了覆盖索引，覆盖索引是指查询结果列中刚好匹配对应顺序所建立的索引.</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>key_len</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度。在不损失精确性的情况下，长度越短越好，key_len显示的值为索引字段的最大可能长度，并非实际使用长度，即key_len是根据表定义计算而得，不是通过表内检索出的</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>ref</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">显示索引的那一列被使用了,如果可能的话，是一个常数。哪些列或常量被用于查找索引列上的值</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>rows</strong>*</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">根据表统计信息及索引选用情况，大致估算出找到所需的记录所需要读取的行数, rows越小越好</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>extra</strong>*</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">包含不适合在其它列中显示但是十分重要的信息</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p><strong>using filesort</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">说明mysql会对数据使用一个外部的索引排序,而不是按照表内的索引顺序进行读取。MySQL中无法利用索引完成的排序操作称为“文件内排序”。(如果排序的时候，必须完全应用组合索引的字段,会产生文件内排序,不能直接使用忽略掉第一个开始的索引字段查询或者排序)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>using temporary</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">使用了临时表保存中间结果,MySQL在对查询结果排序时使用临时表。常见于排序order by和分组查询group by。(使用group by或者order by的时候，必须完全应用组合索引的字段,会产生文件内排序或者创建临时表)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>using index</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">表示相应的select操作中使用了覆盖索引,避免访问了表的数据行，如果同时出现using where,表明索引被用来进行索引键值的查找；如果没有同时出现using where，表明索引被用来读取数据而不是查找数据(覆盖索引)。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>索引覆盖：</strong></p><p>​ select的数据列只用从索引中获得，不必读取数据行，mysql利用索引返回select列表中的字段，不必根据索引再次读取数据文件；(<strong>查询列被所创建的索引覆盖</strong>)</p></li><li><p><strong>using where</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">使用了where过滤</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>using join buffer</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">使用了连接缓存(inner join)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>impossible where</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">where子句的值总是false,不能用来获取任何元素(条件错乱)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>select tables optimized away</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">在没有group by语句下,子句的情况下，基于索引优化MAX、MIN操作或者对于MyISAM引擎优化count(*)操作,不必等到执行阶段再进行计算,查询执行计划生成的阶段完成优化。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>distinct</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">对distinct操作的优化,找到第一个元素后就停止继续查找</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul></li></ol><h3 id="索引分析" tabindex="-1"><a class="header-anchor" href="#索引分析" aria-hidden="true">#</a> 索引分析</h3><ol><li><p>单表</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">如果存在范围类型的字段,可以跳过范围建立索引</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>两张表</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">左连接：索引要加到查询字段(右边表上),解释：左连接左边的数据全有,右边根据字段值匹配左边。</span></span>
<span class="line"><span style="color:#D4D4D4;">右连接：索引建到左表上。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>三张表</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">类似于两张表；</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>join 语句优化</strong></p><ol><li>尽可能减少join的nestedLoop循环总次数，使用<strong>小结果集驱动大结果集</strong>；</li><li>优先优化NestedLoop的内层循环；</li><li>保证join语句中被驱动表上join条件字段已经被索引；</li><li>当无法保证被驱动表的join条件字段被索引且内存充足的情况下，设置JoinBuffer(<strong>my.cnf</strong>).</li></ol></li></ol><h3 id="索引失效" tabindex="-1"><a class="header-anchor" href="#索引失效" aria-hidden="true">#</a> 索引失效</h3><ul><li><p>全值匹配我最爱</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">创建的复合索引,使用的时候最好全部使用,索引才不会失效,如果跳过最左边的索引,索引就会失效。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>最佳左前缀法则</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">第一个字段不能丢失，并且不跳过索引的中间列。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>不在索引列上做任何操作(计算、函数、(自动or手动)类型转换),会导致索引失效转为全表扫描</p></li><li><p>存储引擎不能使用索引中范围条件右边的列</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">类似索引分析的单表。 in or between...and  like</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>尽量使用覆盖索引,只访问索引的查询(索引列和查询列一致),减少select *</p></li><li><p>使用不等于(!=或者&lt;&gt;) 的时候无法使用索引会导致全表扫描</p></li><li><p>is null , is not null 无法使用索引</p></li><li><p>like 以通配符(&#39;%abc&#39;)开头,会导致索引失效,进行全表扫描</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">只在右边写</span><span style="color:#6A9955;">%不影响索引失效</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="解决like-单左边-或者-两边都有-导致索引失效的解决方法" tabindex="-1"><a class="header-anchor" href="#解决like-单左边-或者-两边都有-导致索引失效的解决方法" aria-hidden="true">#</a> <strong>解决like 单左边% 或者 两边都有%导致索引失效的解决方法：</strong></h5><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">使用覆盖索引。</span></span>
<span class="line"><span style="color:#D4D4D4;">	1. 包含like 的字段。但是不能使用select * ,(主键除外)</span></span>
<span class="line"><span style="color:#D4D4D4;">	2. 覆盖索引没有包含的字段，如果查询会导致索引失效</span></span>
<span class="line"><span style="color:#D4D4D4;">		exp: indexs_name_age </span></span>
<span class="line"><span style="color:#D4D4D4;">			select id,name,age from temp  索引可用</span></span>
<span class="line"><span style="color:#D4D4D4;">			select id,name,age,email from temp 索引失效</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>字符串不加单引号会导致索引失效</p></li><li><p>少使用or,会导致索引失效</p></li></ul><p><strong>group by 必排序，可能会有临时表产生</strong></p><h3 id="一般性建议" tabindex="-1"><a class="header-anchor" href="#一般性建议" aria-hidden="true">#</a> 一般性建议</h3><ol><li>对于单值索引，尽量选择针对当前query过滤性更好的索引</li><li>在选择组合索引的时候，当前query中过滤性最好的字段在索引字段顺序中，位置越靠前越好</li><li>在选择组合索引的时候，尽量选择可以能够包含当前query中的where字句中更多字段的索引-&gt;全值匹配</li><li>尽可能通过分析统计信息和调整query的写法来达到选择合适索引的目的</li></ol><h3 id="优化总结口诀" tabindex="-1"><a class="header-anchor" href="#优化总结口诀" aria-hidden="true">#</a> *优化总结口诀</h3><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. 全职匹配我最爱，最左前缀要遵守；</span></span>
<span class="line"><span style="color:#D4D4D4;">2. 带头大哥不能死，中间兄弟不能断；</span></span>
<span class="line"><span style="color:#D4D4D4;">3. 索引列上少计算，范围之后全失效；</span></span>
<span class="line"><span style="color:#D4D4D4;">4. like百分写右边，覆盖索引不写星*；</span></span>
<span class="line"><span style="color:#D4D4D4;">5. 不等空值还有or，索引失效要少用；</span></span>
<span class="line"><span style="color:#D4D4D4;">6. var引号不能丢，sql高级也不难。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查询截取分析" tabindex="-1"><a class="header-anchor" href="#查询截取分析" aria-hidden="true">#</a> 查询截取分析</h2><p><strong>具体步骤：</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. 慢查询的开启和捕获；</span></span>
<span class="line"><span style="color:#D4D4D4;">2. explain + 慢sql分析；</span></span>
<span class="line"><span style="color:#D4D4D4;">3. show profile查询sql在MySQL服务器里执行的细节和生命周期情况；</span></span>
<span class="line"><span style="color:#D4D4D4;">4. MySQL服务器的参数调优。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查询优化" tabindex="-1"><a class="header-anchor" href="#查询优化" aria-hidden="true">#</a> 查询优化</h3><ol><li><h4 id="永远小表驱动大表" tabindex="-1"><a class="header-anchor" href="#永远小表驱动大表" aria-hidden="true">#</a> 永远小表驱动大表；</h4></li></ol><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">exp:</span></span>
<span class="line"><span style="color:#D4D4D4;">select * from A where id in (select id from B);</span></span>
<span class="line"><span style="color:#D4D4D4;">结论： 当B表的数据小于A表的数据，使用in优于exists.</span></span>
<span class="line"><span style="color:#D4D4D4;">select * from A where exists (select 1 from B where B.id = A.id)</span></span>
<span class="line"><span style="color:#D4D4D4;">结论： 当A表的数据小于B表的数据，使用exists优于in.</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><h4 id="order-by-关键字的排序优化" tabindex="-1"><a class="header-anchor" href="#order-by-关键字的排序优化" aria-hidden="true">#</a> order by 关键字的排序优化</h4><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. 双路排序  扫描两次磁盘</span></span>
<span class="line"><span style="color:#D4D4D4;">2. 单路排序  在buffer中对数据进行排序，避免第二次扫描磁盘</span></span>
<span class="line"><span style="color:#D4D4D4;">	如果排序的字段太多，单路排序就变成多路排序，优化方式如下：</span></span>
<span class="line"><span style="color:#D4D4D4;">	2.1. my.cnf sort_buffer_size 缓冲区大小</span></span>
<span class="line"><span style="color:#D4D4D4;">			max_length_for_sort_data</span></span>
<span class="line"><span style="color:#D4D4D4;">	2.2. 使用order by 避免使用select *</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>总结：</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. Mysql两种排序方式： FileSort(文件内排序) 和 扫描有序索引排序</span></span>
<span class="line"><span style="color:#D4D4D4;">2. Mysql可以为排序与查询使用相同索引</span></span>
<span class="line"><span style="color:#D4D4D4;">3. order by 使用索引的条件以及不会产生文件内排序</span></span>
<span class="line"><span style="color:#D4D4D4;">	前提条件：索引 key_a_b_c(a,b,c)</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.1 order by 能使用索引最左前缀</span></span>
<span class="line"><span style="color:#D4D4D4;">		order by a</span></span>
<span class="line"><span style="color:#D4D4D4;">		order by a,b</span></span>
<span class="line"><span style="color:#D4D4D4;">		order by a,b,c</span></span>
<span class="line"><span style="color:#D4D4D4;">		order by a desc,b desc,c desc （排序的顺序必须保持一致）</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.2 如果where使用索引的最左前缀定义为常量，则order by 可以使用索引</span></span>
<span class="line"><span style="color:#D4D4D4;">		where a = const order by b,c</span></span>
<span class="line"><span style="color:#D4D4D4;">		where a = const and b = const order by c</span></span>
<span class="line"><span style="color:#D4D4D4;">		where a = const and b &gt; const order by b,c</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.3 不能使用索引进行排序</span></span>
<span class="line"><span style="color:#D4D4D4;">		order by a asc,b desc,c desc  #排序不一致</span></span>
<span class="line"><span style="color:#D4D4D4;">		where g = const order by b,c  #丢失最左索引</span></span>
<span class="line"><span style="color:#D4D4D4;">		where a = const order by c 	  #中间断开,丢失中间索引</span></span>
<span class="line"><span style="color:#D4D4D4;">		where a = const order by a,d  #d不是索引的字段</span></span>
<span class="line"><span style="color:#D4D4D4;">		where a in (...) order by b,c #对于排序来说，多个相等条件也是范围查询 in 会导致索引失效</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><h4 id="group-by-关键字的优化" tabindex="-1"><a class="header-anchor" href="#group-by-关键字的优化" aria-hidden="true">#</a> group by 关键字的优化</h4><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. group by 实际上是先进行排序，遵照索引的最左前缀原则</span></span>
<span class="line"><span style="color:#D4D4D4;">2. 其它优化与order by 的单路排序优化类似，需要调整 sort_buffer_size 和 max_length_for_sort_data</span></span>
<span class="line"><span style="color:#D4D4D4;">3. where 高于 having，如果可以在where中限定，就不需要使用having</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><h4 id="慢查询日志" tabindex="-1"><a class="header-anchor" href="#慢查询日志" aria-hidden="true">#</a> 慢查询日志</h4><h5 id="_4-1-慢查询日志的含义" tabindex="-1"><a class="header-anchor" href="#_4-1-慢查询日志的含义" aria-hidden="true">#</a> 4.1 慢查询日志的含义</h5><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. MySQL提供的一种日志记录，用来记录响应时间超过阀值的sql语句，具体值运行时间超过long_query_time值的sql，会被记录到慢查询日志中。</span></span>
<span class="line"><span style="color:#D4D4D4;">2. long_query_time默认值是10秒。</span></span>
<span class="line"><span style="color:#D4D4D4;">3. 响应超时的语句，再结合explain 进行分析。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_4-2-慢查询日志的说明" tabindex="-1"><a class="header-anchor" href="#_4-2-慢查询日志的说明" aria-hidden="true">#</a> 4.2 慢查询日志的说明</h5><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. MySQL数据库默认没有开启慢查询日志，需要手动去设置这个参数。</span></span>
<span class="line"><span style="color:#D4D4D4;">2. 不是进行调优，不建议开启慢查询日志。会对性能造成一定的影响。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_4-3-操作慢查询日志" tabindex="-1"><a class="header-anchor" href="#_4-3-操作慢查询日志" aria-hidden="true">#</a> 4.3 操作慢查询日志</h5><p>4.3.1 命令行的操作</p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">#查看慢查询日志的状态以及文件名称</span></span>
<span class="line"><span style="color:#D4D4D4;">show variables </span><span style="color:#569CD6;">like</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;%slow_query_log%&#39;</span><span style="color:#D4D4D4;">; </span></span>
<span class="line"><span style="color:#D4D4D4;">#开启慢查询日志，临时生效，重启之后就失效</span></span>
<span class="line"><span style="color:#D4D4D4;"># 也可以在my.cnf中进行设置，mysql会默认给一个慢查询日志文件名称 [host_name]-slow.log</span></span>
<span class="line"><span style="color:#569CD6;">set</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">global</span><span style="color:#D4D4D4;"> slow_query_log = </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">;	 </span></span>
<span class="line"><span style="color:#D4D4D4;">#查看默认阀值，可以同上一样进行修改设置，mysql内部对此的判断是*大于*,而不是*大于等于*</span></span>
<span class="line"><span style="color:#D4D4D4;">show variables </span><span style="color:#569CD6;">like</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;%long_query_time%&#39;</span><span style="color:#D4D4D4;">;					</span></span>
<span class="line"><span style="color:#D4D4D4;">#设置阀值的秒数</span></span>
<span class="line"><span style="color:#D4D4D4;"># 如果设置后进行查询数值没有更改：</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">. 可以重新开启一个mysql连接在进行查询</span></span>
<span class="line"><span style="color:#D4D4D4;">#							 </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">. show </span><span style="color:#569CD6;">global</span><span style="color:#D4D4D4;"> variables </span><span style="color:#569CD6;">like</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;%long_query_time%&#39;</span><span style="color:#D4D4D4;">; </span></span>
<span class="line"><span style="color:#D4D4D4;"># 查看慢查询日志 可以使用select sleep([number]); 当作测试超过阀值的sql</span></span>
<span class="line"><span style="color:#569CD6;">set</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">global</span><span style="color:#D4D4D4;"> long_query_time = [number];</span></span>
<span class="line"><span style="color:#D4D4D4;"># 查看慢查询日志中总共有多少条sql</span></span>
<span class="line"><span style="color:#D4D4D4;">show variables </span><span style="color:#569CD6;">like</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;%slow_querys%&#39;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4.3.2 配置文件</p><div class="language-ini ext-ini line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">#配置文件下的修改</span></span>
<span class="line"><span style="color:#569CD6;">slow_query_log</span><span style="color:#D4D4D4;">=1</span></span>
<span class="line"><span style="color:#569CD6;">slow_query_log_file</span><span style="color:#D4D4D4;">=/var/lib/mysql/slow_query_sql-slow.log</span></span>
<span class="line"><span style="color:#569CD6;">long_query_time</span><span style="color:#D4D4D4;">=3</span></span>
<span class="line"><span style="color:#569CD6;">log_output</span><span style="color:#D4D4D4;">=FILE</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_4-4-mysql日志分析工具mysqldumpslow" tabindex="-1"><a class="header-anchor" href="#_4-4-mysql日志分析工具mysqldumpslow" aria-hidden="true">#</a> 4.4 MySQL日志分析工具<em>mysqldumpslow</em></h5><p><img src="/db/mysql/mysql_mysql_dump_slow_params.png" alt="工具的常用参数"></p><p><img src="/db/mysql/mysql_mysql_dump_slow.png" alt="常用的语句"></p></li></ol><h3 id="批量插入数据脚本" tabindex="-1"><a class="header-anchor" href="#批量插入数据脚本" aria-hidden="true">#</a> 批量插入数据脚本</h3><p>*： 在命令行界面创建MySQL函数，语句中会包含许多分号(结束标记)，因此需要定义另外一种结束标记符号。</p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;"># 定义 $$为结束标记</span></span>
<span class="line"><span style="color:#D4D4D4;">DELIMITER $$</span></span>
<span class="line"><span style="color:#D4D4D4;">...</span></span>
<span class="line"><span style="color:#569CD6;">set</span><span style="color:#D4D4D4;"> autocommit = </span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">; #设置不自动提交</span></span>
<span class="line"><span style="color:#569CD6;">repeat</span></span>
<span class="line"><span style="color:#D4D4D4;">... #执行插入语句</span></span>
<span class="line"><span style="color:#D4D4D4;">until i&gt;</span><span style="color:#DCDCAA;">max</span></span>
<span class="line"><span style="color:#569CD6;">end</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">repeat</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#569CD6;">COMMIT</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#569CD6;">END</span><span style="color:#D4D4D4;"> $$</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>exp:</p><p><img src="/db/mysql/mysql_batch_insert.png" alt="批量插入数据脚本示例"></p><h3 id="show-profile-分析" tabindex="-1"><a class="header-anchor" href="#show-profile-分析" aria-hidden="true">#</a> show profile 分析</h3><ol><li><h4 id="show-profile是什么" tabindex="-1"><a class="header-anchor" href="#show-profile是什么" aria-hidden="true">#</a> show profile是什么</h4><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">MySQL提供用来分析当前会话中语句执行的资源消耗情况，用于sql的调优测量。相当于sql的完成生命周期</span></span>
<span class="line"><span style="color:#D4D4D4;">默认处于关闭状态，并保存最近15次的运行结果</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><h4 id="查看是否show-profile状态" tabindex="-1"><a class="header-anchor" href="#查看是否show-profile状态" aria-hidden="true">#</a> 查看是否show profile状态</h4><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">show variables </span><span style="color:#569CD6;">like</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;profiling&#39;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;"># 开启profile</span></span>
<span class="line"><span style="color:#569CD6;">set</span><span style="color:#D4D4D4;"> profiling = </span><span style="color:#569CD6;">on</span><span style="color:#D4D4D4;">; </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><h3 id="show-profile-使用方法" tabindex="-1"><a class="header-anchor" href="#show-profile-使用方法" aria-hidden="true">#</a> show profile 使用方法</h3><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">#</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">. 开启profile </span></span>
<span class="line"><span style="color:#569CD6;">set</span><span style="color:#D4D4D4;"> profiling = </span><span style="color:#569CD6;">on</span><span style="color:#D4D4D4;">; </span></span>
<span class="line"><span style="color:#D4D4D4;">#</span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">. 运行sql语句</span></span>
<span class="line"><span style="color:#D4D4D4;">#</span><span style="color:#B5CEA8;">3</span><span style="color:#D4D4D4;">. 执行show profiles;查看结果</span></span>
<span class="line"><span style="color:#D4D4D4;">show profiles;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#D4D4D4;">#结果&gt; Query_ID Duration Query</span></span>
<span class="line"><span style="color:#D4D4D4;">#</span><span style="color:#B5CEA8;">4</span><span style="color:#D4D4D4;">. 查看诊断结果 </span></span>
<span class="line"><span style="color:#D4D4D4;">show </span><span style="color:#569CD6;">profile</span><span style="color:#D4D4D4;"> cpu,</span><span style="color:#569CD6;">block</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">io</span><span style="color:#D4D4D4;"> for query [上一步的Query_ID];</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#D4D4D4;">#结果&gt; </span><span style="color:#569CD6;">Status</span><span style="color:#D4D4D4;"> Duration Cpu_user Cpu_system Block_ops_in Block_ops_out</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结论：（第4步执行的结果中，Status字段）</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. converting HEAP to MyISam 查询结果太大，内存不够使用 转移到磁盘上存储</span></span>
<span class="line"><span style="color:#D4D4D4;">2. Creating tmp table 拷贝数据到临时表，用完之后在进行删除</span></span>
<span class="line"><span style="color:#D4D4D4;">3. Copying to tmp table on disk ****把内存中数据复制到磁盘****</span></span>
<span class="line"><span style="color:#D4D4D4;">4. locked </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/db/mysql/mysql_show_profile_param.png" alt="show_profile的可查询参数"></p></li></ol><h3 id="全局查询日志" tabindex="-1"><a class="header-anchor" href="#全局查询日志" aria-hidden="true">#</a> 全局查询日志</h3><ol><li><p>不建议在测试晚景中使用此功能</p></li><li><p>配置启用</p><div class="language-ini ext-ini line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">#开启</span></span>
<span class="line"><span style="color:#569CD6;">general_log</span><span style="color:#D4D4D4;"> = 1</span></span>
<span class="line"><span style="color:#6A9955;">#记录日志文件的位置</span></span>
<span class="line"><span style="color:#569CD6;">general_log_file</span><span style="color:#D4D4D4;"> = /path/logfile</span></span>
<span class="line"><span style="color:#6A9955;">#输出格式</span></span>
<span class="line"><span style="color:#569CD6;">log_output</span><span style="color:#D4D4D4;"> = FILE</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>命令启用</p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">#开启</span></span>
<span class="line"><span style="color:#569CD6;">set</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">global</span><span style="color:#D4D4D4;"> general_log = </span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#569CD6;">set</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">global</span><span style="color:#D4D4D4;"> log_output = </span><span style="color:#CE9178;">&#39;TABLE&#39;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">#查询日志,经过上面两条命令，你所编写的sql会记录到mysql库下的general_log表中</span></span>
<span class="line"><span style="color:#569CD6;">select</span><span style="color:#D4D4D4;"> * </span><span style="color:#569CD6;">from</span><span style="color:#D4D4D4;"> mysql.general_log;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="数据库锁理论" tabindex="-1"><a class="header-anchor" href="#数据库锁理论" aria-hidden="true">#</a> 数据库锁理论</h2><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">读锁共享 写锁排它</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>表锁的命令：</p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;"># 查看有没有锁 查看 in_use 是否为1-加锁</span></span>
<span class="line"><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">. show </span><span style="color:#569CD6;">open</span><span style="color:#D4D4D4;"> tables;</span></span>
<span class="line"><span style="color:#D4D4D4;"># 添加锁的命令</span></span>
<span class="line"><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">. lock </span><span style="color:#569CD6;">table</span><span style="color:#D4D4D4;"> [table1] </span><span style="color:#569CD6;">read</span><span style="color:#D4D4D4;">,[table2] write;</span></span>
<span class="line"><span style="color:#D4D4D4;"># 释放锁</span></span>
<span class="line"><span style="color:#B5CEA8;">3</span><span style="color:#D4D4D4;">. </span><span style="color:#569CD6;">unlock</span><span style="color:#D4D4D4;"> tables;</span></span>
<span class="line"><span style="color:#D4D4D4;"># 分析表锁定 </span></span>
<span class="line"><span style="color:#D4D4D4;">#	Table_locks_immediate:产生表锁的次数，表示可以立即获取锁的查询次数，每次获取立即加1</span></span>
<span class="line"><span style="color:#D4D4D4;">#	Table_locks_waited:出现表级锁争用而发生的等待次数。没等待一次立即加1，表示严重的锁争用情况</span></span>
<span class="line"><span style="color:#B5CEA8;">4</span><span style="color:#D4D4D4;">. show </span><span style="color:#569CD6;">status</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">like</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;table%&#39;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><p>表锁（偏读）</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. 偏向MyISAM存储引擎，开销小，加锁快；无死锁，锁粒度大，发生锁冲突概率最高，并发度最低。</span></span>
<span class="line"><span style="color:#D4D4D4;">2. MyISAM读写调度是写优先，因此不适合做写为主的表引擎。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">#</span><span style="color:#B5CEA8;">1</span><span style="color:#D4D4D4;">. sessionA 对一张A表加*读*锁，只可以对A表进行查询。不能更新A表和查询其它表。</span></span>
<span class="line"><span style="color:#D4D4D4;">#	sessionB 对A表可以查询，对其他表也可以进行查询更新，但是更新A表时，会阻塞到更新的地方，等待A表释放锁才可以更新数据。</span></span>
<span class="line"><span style="color:#D4D4D4;">#</span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">. sessionA 对一张A表加*写*锁，可以对表进行读和更新，不能查询和更新其它表。</span></span>
<span class="line"><span style="color:#D4D4D4;">#	sessionB 对A表进行查询，会进行阻塞等待sessionA释放锁。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/db/mysql/mysql_MyISAM_lock.png" alt="MyISAM的锁的使用结论"></p><p>读锁会阻塞写，但是不会阻塞读；写锁会把读和写全部阻塞</p></li><li><p>行锁（偏写）</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. 偏向InnoDB存储引擎，开销大，加锁慢；会出现死锁；锁粒度最小，发生锁冲突的概率最低，并发度也最高。</span></span>
<span class="line"><span style="color:#D4D4D4;">2. 与MyISAM引擎的不同： 支持事物；行级锁。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/db/mysql/mysql_transaction_basic.png" alt="事务"></p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">#查看默认事务隔离级别</span></span>
<span class="line"><span style="color:#D4D4D4;">show variables </span><span style="color:#569CD6;">like</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;%tx_isolation%&#39;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;"># 分析表行锁定 </span></span>
<span class="line"><span style="color:#D4D4D4;">#	Table_locks_immediate:产生表锁的次数，表示可以立即获取锁的查询次数，每次获取立即加1</span></span>
<span class="line"><span style="color:#D4D4D4;">#	Table_locks_waited:出现表级锁争用而发生的等待次数。没等待一次立即加1，表示严重的锁争用情况</span></span>
<span class="line"><span style="color:#D4D4D4;">******show </span><span style="color:#569CD6;">status</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">like</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;innodb_row_table%&#39;</span><span style="color:#D4D4D4;">;******</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/db/mysql/mysql_innodb_row_lock.png" alt="mysql行锁定的分析"></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">如果设置sessionA 和 sessionB都设置set autocommit = 0;</span></span>
<span class="line"><span style="color:#D4D4D4;">sessionA更新表的记录 执行commit; sessionB 查询不到，必须先进行commit,在查询数据。</span></span>
<span class="line"><span style="color:#D4D4D4;">相当于开启了不同的事物</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>索引失效会导致行锁变表锁</strong></p><p><strong>间隙锁：</strong></p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">当使用范围检索数据而不是相等条件检索数据，并请求共享或排它锁时，InnoDB会给复合条件的已有数据的索引项添加锁。对于键值在条件范围内，但是不存在于表记录中的叫*间隙*(GAP)。也会对间隙加锁。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>手动给某行数据添加锁：</strong></p><div class="language-sql ext-sql line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;"># 锁定where条件的行</span></span>
<span class="line"><span style="color:#569CD6;">select</span><span style="color:#D4D4D4;"> * </span><span style="color:#569CD6;">from</span><span style="color:#D4D4D4;"> ${tableName} </span><span style="color:#569CD6;">where</span><span style="color:#D4D4D4;"> ... for </span><span style="color:#569CD6;">update</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;"># commit之后取消锁定</span></span>
<span class="line"><span style="color:#569CD6;">commit</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>页锁</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">基本上处于表锁和行锁之间，不支持并发，会出现死锁。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ol><h2 id="主从复制" tabindex="-1"><a class="header-anchor" href="#主从复制" aria-hidden="true">#</a> 主从复制</h2><h3 id="复制基本原理" tabindex="-1"><a class="header-anchor" href="#复制基本原理" aria-hidden="true">#</a> 复制基本原理</h3><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">slave会从master读取binlog来进行数据同步</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>mysql复制过程：</p><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. master 将改变记录到二进制日志(binary log),过程被称为二进制日志事件，binary log events</span></span>
<span class="line"><span style="color:#D4D4D4;">2. slave 将master的binary log events拷贝到它的中继日志(relay log)</span></span>
<span class="line"><span style="color:#D4D4D4;">3. slave 重做中继日志的事件，将改变应用到自己的数据库中。mysql复制时异步串行的</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="主从复制配置" tabindex="-1"><a class="header-anchor" href="#主从复制配置" aria-hidden="true">#</a> 主从复制配置</h3><blockquote><p>https://www.cnblogs.com/alvin_xp/p/4162249.html</p></blockquote><div class="language-tex ext-tex line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">1. mysql版本必须保持一致</span></span>
<span class="line"><span style="color:#D4D4D4;">2. 主从配置在[mysqld]节点下，都是小写</span></span>
<span class="line"><span style="color:#D4D4D4;">3. 主机修改my.ini配置文件</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.1 *主服务器唯一id server-id=1</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.2 *启用二进制日志 log-bin=本地路径/mysqlbin</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.3 启用错误日志 log-err=本地路径/mysqlerr</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.4 根目录	basedir=本地安装的目录</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.5 临时目录 tmpdir=自定义的目录</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.6 数据目录 datadir=自定义的目录</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.7 主机读写都可以	read-only=0</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.8 设置不需要复制的数据库	binlog-ignore-db=mysql （mysql是mysql安装完成后就默认存在的数据库）</span></span>
<span class="line"><span style="color:#D4D4D4;">	3.9 设置需要复制的数据库 binlog-do-db=[数据库名称]</span></span>
<span class="line"><span style="color:#D4D4D4;">4. 从机修改my.ini配置文件</span></span>
<span class="line"><span style="color:#D4D4D4;">	4.1 *从服务器唯一id</span></span>
<span class="line"><span style="color:#D4D4D4;">	4.2 启用二进制日志</span></span>
<span class="line"><span style="color:#D4D4D4;">5. 修改完配置后，重新启动mysql服务</span></span>
<span class="line"><span style="color:#D4D4D4;">6. 主机和从机都需要关闭防火墙  linux: service iptables stop</span></span>
<span class="line"><span style="color:#D4D4D4;">7. 在主机上建立账户并授权slave</span></span>
<span class="line"><span style="color:#D4D4D4;">	grant replication slave on *.* to &#39;username&#39;@&#39;从机的ip地址&#39; identified by &#39;password&#39;;</span></span>
<span class="line"><span style="color:#D4D4D4;">	flush privileges;   刷新环境</span></span>
<span class="line"><span style="color:#D4D4D4;">	show master status; 查看master状态,文件名称 和位置</span></span>
<span class="line"><span style="color:#D4D4D4;">8. 在从机上配置需要复制的主机,**在配置之前必须先查询show master status;</span></span>
<span class="line"><span style="color:#D4D4D4;">	grant master to master_host=&#39;[主机ip]&#39;, master_user=&#39;[主机分配的用户]&#39;,master_password=&#39;[主机分配的密码]&#39;,master_log_file=&#39;[shwo master status；的file]&#39;,master_log_pos=[shwo master status;的postion];</span></span>
<span class="line"><span style="color:#D4D4D4;">	start slave; 启动从服务器复制功能</span></span>
<span class="line"><span style="color:#D4D4D4;">	show slave status</span><span style="color:#DCDCAA;">\G</span><span style="color:#D4D4D4;">;(</span><span style="color:#DCDCAA;">\G</span><span style="color:#D4D4D4;">:key-value显示) slave_io_running:yes slave_sql_running:yes 代表配置成功  </span></span>
<span class="line"><span style="color:#D4D4D4;"> 9. 可以在主机上进行建库建表进行测试</span></span>
<span class="line"><span style="color:#D4D4D4;"> 10.停止从服务的复制功能</span></span>
<span class="line"><span style="color:#D4D4D4;"> 	在从机中执行： stop slave;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/lonlyz/blog/edit/main/docs/db/mysql.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><!--]--> 在 GitHub 上编辑此页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 786321279@qq.com">lz</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/db/mycat.html" class="" aria-label="Mycat"><!--[--><!--]--> Mycat <!--[--><!--]--></a></span><span class="next"><a href="/db/redis.html" class="" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.2d179ac6.js" defer></script>
  </body>
</html>
